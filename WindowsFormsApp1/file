// the following is the content of file WindowsFormsApp1\AddBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class AddBookForm : Form
    {
        public AddBookForm()
        {
            InitializeComponent();
        }
        private void AddBookSubmitButton_Click(object sender, EventArgs e)
        {
            if (AddBookIdTextBox.Text.Trim() == "" || AddBookNameTextBox.Text.Trim() == "" || AddBookAuthorTextBox.Text.Trim() == "" || AddBookScoreTextBox.Text.Trim() == "" || AddBookPressTextBox.Text.Trim() == "" || AddBookPriceTextBox.Text.Trim() == "" || AddBookAmountTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请填写完整信息！", "警告");
            }
            else if (MySqlHelper.IsBookExistsWithId(AddBookIdTextBox.Text.Trim()))
            {
                MessageBox.Show("图书编号已存在!", "警告");
                return;
            }
            else
            { 
                // 添加操作
                string sql = "insert into books values(@bookId, @bookName, @author, @score, @press, @price, @amount)";
                MyDictionary dic = new MyDictionary();
                dic.Add("@bookId", AddBookIdTextBox.Text.Trim());
                dic.Add("@bookName", AddBookNameTextBox.Text.Trim());
                dic.Add("@author", AddBookAuthorTextBox.Text.Trim());
                dic.Add("@score", AddBookScoreTextBox.Text.Trim());
                dic.Add("@press", AddBookPressTextBox.Text.Trim());
                dic.Add("@price", AddBookPriceTextBox.Text.Trim());
                dic.Add("@amount", AddBookAmountTextBox.Text.Trim());
                int i = MySqlHelper.ExecuteNonQuery(sql, dic);
                if (i == 1)
                {
                    MessageBox.Show("图书添加成功!", "提示");
                }
            }
        }
    }
}

// the following is the content of file WindowsFormsApp1\AddBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class AddBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.AddBookIdLabel = new System.Windows.Forms.Label();
            this.AddBookNameLabel = new System.Windows.Forms.Label();
            this.AddBookAuthorLabel = new System.Windows.Forms.Label();
            this.AddBookScoreLabel = new System.Windows.Forms.Label();
            this.AddBookPressLabel = new System.Windows.Forms.Label();
            this.AddBookPriceLabel = new System.Windows.Forms.Label();
            this.AddBookIdTextBox = new System.Windows.Forms.TextBox();
            this.AddBookNameTextBox = new System.Windows.Forms.TextBox();
            this.AddBookAuthorTextBox = new System.Windows.Forms.TextBox();
            this.AddBookScoreTextBox = new System.Windows.Forms.TextBox();
            this.AddBookPressTextBox = new System.Windows.Forms.TextBox();
            this.AddBookPriceTextBox = new System.Windows.Forms.TextBox();
            this.AddBookSubmitButton = new System.Windows.Forms.Button();
            this.AddBookAmountLabel = new System.Windows.Forms.Label();
            this.AddBookAmountTextBox = new System.Windows.Forms.TextBox();
            this.SuspendLayout();
            // 
            // AddBookIdLabel
            // 
            this.AddBookIdLabel.AutoSize = true;
            this.AddBookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookIdLabel.Location = new System.Drawing.Point(109, 69);
            this.AddBookIdLabel.Name = "AddBookIdLabel";
            this.AddBookIdLabel.Size = new System.Drawing.Size(85, 21);
            this.AddBookIdLabel.TabIndex = 0;
            this.AddBookIdLabel.Text = "图书编号：";
            // 
            // AddBookNameLabel
            // 
            this.AddBookNameLabel.AutoSize = true;
            this.AddBookNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookNameLabel.Location = new System.Drawing.Point(139, 125);
            this.AddBookNameLabel.Name = "AddBookNameLabel";
            this.AddBookNameLabel.Size = new System.Drawing.Size(55, 21);
            this.AddBookNameLabel.TabIndex = 1;
            this.AddBookNameLabel.Text = "书名：";
            // 
            // AddBookAuthorLabel
            // 
            this.AddBookAuthorLabel.AutoSize = true;
            this.AddBookAuthorLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookAuthorLabel.Location = new System.Drawing.Point(139, 182);
            this.AddBookAuthorLabel.Name = "AddBookAuthorLabel";
            this.AddBookAuthorLabel.Size = new System.Drawing.Size(55, 21);
            this.AddBookAuthorLabel.TabIndex = 2;
            this.AddBookAuthorLabel.Text = "作者：";
            // 
            // AddBookScoreLabel
            // 
            this.AddBookScoreLabel.AutoSize = true;
            this.AddBookScoreLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookScoreLabel.Location = new System.Drawing.Point(139, 243);
            this.AddBookScoreLabel.Name = "AddBookScoreLabel";
            this.AddBookScoreLabel.Size = new System.Drawing.Size(55, 21);
            this.AddBookScoreLabel.TabIndex = 3;
            this.AddBookScoreLabel.Text = "评分：";
            // 
            // AddBookPressLabel
            // 
            this.AddBookPressLabel.AutoSize = true;
            this.AddBookPressLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookPressLabel.Location = new System.Drawing.Point(411, 69);
            this.AddBookPressLabel.Name = "AddBookPressLabel";
            this.AddBookPressLabel.Size = new System.Drawing.Size(70, 21);
            this.AddBookPressLabel.TabIndex = 4;
            this.AddBookPressLabel.Text = "出版社：";
            // 
            // AddBookPriceLabel
            // 
            this.AddBookPriceLabel.AutoSize = true;
            this.AddBookPriceLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookPriceLabel.Location = new System.Drawing.Point(426, 125);
            this.AddBookPriceLabel.Name = "AddBookPriceLabel";
            this.AddBookPriceLabel.Size = new System.Drawing.Size(55, 21);
            this.AddBookPriceLabel.TabIndex = 5;
            this.AddBookPriceLabel.Text = "价格：";
            // 
            // AddBookIdTextBox
            // 
            this.AddBookIdTextBox.Location = new System.Drawing.Point(200, 65);
            this.AddBookIdTextBox.Name = "AddBookIdTextBox";
            this.AddBookIdTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookIdTextBox.TabIndex = 6;
            // 
            // AddBookNameTextBox
            // 
            this.AddBookNameTextBox.Location = new System.Drawing.Point(200, 121);
            this.AddBookNameTextBox.Name = "AddBookNameTextBox";
            this.AddBookNameTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookNameTextBox.TabIndex = 7;
            // 
            // AddBookAuthorTextBox
            // 
            this.AddBookAuthorTextBox.Location = new System.Drawing.Point(200, 182);
            this.AddBookAuthorTextBox.Name = "AddBookAuthorTextBox";
            this.AddBookAuthorTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookAuthorTextBox.TabIndex = 8;
            // 
            // AddBookScoreTextBox
            // 
            this.AddBookScoreTextBox.Location = new System.Drawing.Point(200, 239);
            this.AddBookScoreTextBox.Name = "AddBookScoreTextBox";
            this.AddBookScoreTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookScoreTextBox.TabIndex = 9;
            // 
            // AddBookPressTextBox
            // 
            this.AddBookPressTextBox.Location = new System.Drawing.Point(487, 65);
            this.AddBookPressTextBox.Name = "AddBookPressTextBox";
            this.AddBookPressTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookPressTextBox.TabIndex = 10;
            // 
            // AddBookPriceTextBox
            // 
            this.AddBookPriceTextBox.Location = new System.Drawing.Point(487, 121);
            this.AddBookPriceTextBox.Name = "AddBookPriceTextBox";
            this.AddBookPriceTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookPriceTextBox.TabIndex = 11;
            // 
            // AddBookSubmitButton
            // 
            this.AddBookSubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookSubmitButton.Location = new System.Drawing.Point(302, 319);
            this.AddBookSubmitButton.Name = "AddBookSubmitButton";
            this.AddBookSubmitButton.Size = new System.Drawing.Size(201, 31);
            this.AddBookSubmitButton.TabIndex = 12;
            this.AddBookSubmitButton.Text = "提交";
            this.AddBookSubmitButton.UseVisualStyleBackColor = true;
            this.AddBookSubmitButton.Click += new System.EventHandler(this.AddBookSubmitButton_Click);
            // 
            // AddBookAmountLabel
            // 
            this.AddBookAmountLabel.AutoSize = true;
            this.AddBookAmountLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddBookAmountLabel.Location = new System.Drawing.Point(426, 186);
            this.AddBookAmountLabel.Name = "AddBookAmountLabel";
            this.AddBookAmountLabel.Size = new System.Drawing.Size(55, 21);
            this.AddBookAmountLabel.TabIndex = 13;
            this.AddBookAmountLabel.Text = "数量：";
            // 
            // AddBookAmountTextBox
            // 
            this.AddBookAmountTextBox.Location = new System.Drawing.Point(487, 182);
            this.AddBookAmountTextBox.Name = "AddBookAmountTextBox";
            this.AddBookAmountTextBox.Size = new System.Drawing.Size(166, 25);
            this.AddBookAmountTextBox.TabIndex = 14;
            // 
            // AddBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(789, 406);
            this.Controls.Add(this.AddBookAmountTextBox);
            this.Controls.Add(this.AddBookAmountLabel);
            this.Controls.Add(this.AddBookSubmitButton);
            this.Controls.Add(this.AddBookPriceTextBox);
            this.Controls.Add(this.AddBookPressTextBox);
            this.Controls.Add(this.AddBookScoreTextBox);
            this.Controls.Add(this.AddBookAuthorTextBox);
            this.Controls.Add(this.AddBookNameTextBox);
            this.Controls.Add(this.AddBookIdTextBox);
            this.Controls.Add(this.AddBookPriceLabel);
            this.Controls.Add(this.AddBookPressLabel);
            this.Controls.Add(this.AddBookScoreLabel);
            this.Controls.Add(this.AddBookAuthorLabel);
            this.Controls.Add(this.AddBookNameLabel);
            this.Controls.Add(this.AddBookIdLabel);
            this.Name = "AddBookForm";
            this.Text = "图书入库";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label AddBookIdLabel;
        private System.Windows.Forms.Label AddBookNameLabel;
        private System.Windows.Forms.Label AddBookAuthorLabel;
        private System.Windows.Forms.Label AddBookScoreLabel;
        private System.Windows.Forms.Label AddBookPressLabel;
        private System.Windows.Forms.Label AddBookPriceLabel;
        private System.Windows.Forms.TextBox AddBookIdTextBox;
        private System.Windows.Forms.TextBox AddBookNameTextBox;
        private System.Windows.Forms.TextBox AddBookAuthorTextBox;
        private System.Windows.Forms.TextBox AddBookScoreTextBox;
        private System.Windows.Forms.TextBox AddBookPressTextBox;
        private System.Windows.Forms.TextBox AddBookPriceTextBox;
        private System.Windows.Forms.Button AddBookSubmitButton;
        private System.Windows.Forms.Label AddBookAmountLabel;
        private System.Windows.Forms.TextBox AddBookAmountTextBox;
    }
}
// the following is the content of file WindowsFormsApp1\BorrowBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class BorrowBookForm : Form
    {
        public BorrowBookForm()
        {
            InitializeComponent();
        }

        private string _Id;
        public string Id
        {
            get { return _Id; }
            set { _Id = value; }
        }

        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }
        private void BorrowBookForm_Load(object sender, EventArgs e)
        {
            BorrowBookUserTextBox.ReadOnly = false;
            BorrowBookUserTextBox.Text = Id;
            BorrowBookUserTextBox.ReadOnly = true;
            if (_Tag == "admin")
            {
                SubmitButton.Enabled = false;
            }
        }

        // 查询图书
        private void BorrowBookSearchButton_Click(object sender, EventArgs e)
        {
            if (SearchBookNameTextBox.Text.Trim() == "")
            {
                MessageBox.Show("书名不能为空", "警告");
            }
            else
            {
                string sql = string.Format("select bookId, bookName, author, score, press, price, amount from books where bookName like '%" + SearchBookNameTextBox.Text.Trim() + "%'");
                DataTable dt = MySqlHelper.GetList(sql);
                this.BorrowBookDataGridView.DataSource = dt;
            }
        }

        private void BorrowBookDataGridView_CellMouseUp(object sender, DataGridViewCellMouseEventArgs e)
        {
            // 开关文本框的锁定，将表格内的数据显示到文本框内
            int a = BorrowBookDataGridView.CurrentRow.Index;
            BorrowBookIdTextBox.ReadOnly = false;
            BorrowBookNameTextBox.ReadOnly = false;
            BorrowBookPriceTextBox.ReadOnly = false;
            BorrowBookIdTextBox.Text = BorrowBookDataGridView.Rows[a].Cells["ColumnBookId"].Value.ToString();
            BorrowBookNameTextBox.Text = BorrowBookDataGridView.Rows[a].Cells["ColumnBookName"].Value.ToString();
            BorrowBookPriceTextBox.Text = BorrowBookDataGridView.Rows[a].Cells["ColumnPrice"].Value.ToString();
            BorrowBookIdTextBox.ReadOnly = true;
            BorrowBookNameTextBox.ReadOnly = true;
            BorrowBookPriceTextBox.ReadOnly = true;
        }

        private void SubmitButton_Click(object sender, EventArgs e)
        {
            if (BorrowBookTimeComboBox.Text.ToString().Trim() == "")
            {
                MessageBox.Show("请选择借阅时长！", "警告");
                return;
            }
            else if (BorrowBookIdTextBox.Text.Trim() == "" || BorrowBookNameTextBox.Text.Trim() == "" || BorrowBookPriceTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请选择书籍！", "警告");
            }
            else
            {
                // 自动生成借书单号
                string sql = "select MAX(borrowNumber)+1 from borrowlist";
                string borrowNumber = MySqlHelper.ExecuteScalar(sql).ToString();
                StringBuilder sb = new StringBuilder(borrowNumber);
                while (sb.Length != 6)
                {
                    sb.Insert(0, "0");
                }
                borrowNumber = sb.ToString();

                // 查询书籍库存量
                sql = "select amount from books where bookId = @bookId";
                MyDictionary dic1 = new MyDictionary();
                dic1.Add("@bookId", BorrowBookIdTextBox.Text.Trim());
                string n = MySqlHelper.ExecuteScalar(sql, dic1).ToString();
                if (n == "0")
                {
                    MessageBox.Show("该书籍库存量为零！", "警告");
                    return; 
                }

                // 插入数据到借书表（borrow）
                //sql = string.Format("insert into borrowlist values(@borrowNumber, @userId, @bookId, @bookName, convert(varchar(20),GETDATE() ,111),convert(varchar(20),dateadd(day," + BorrowBookTimeComboBox.Text.ToString().Substring(0, 2) + ", CONVERT(varchar(20),GETDATE() ,111)),111), @overDue)");
                //sql = string.Format("insert into borrowlist values(@borrowNumber, @userId, @bookId, @bookName, curdate(), date_add(curdate(), interval 30 day), @overDue)");

                //TODO: 这里我要将下面这段代码改成调用处理过程，处理过程中使用事务的形式


                sql = string.Format("call borrowBooks(@borrowNumber, @userId, @bookId, @bookName, @duration, @overDue)");//利用处理过程+事务+写锁的方式来处理并发
                MyDictionary dic = new MyDictionary();
                dic.Add("@borrowNumber", borrowNumber);
                dic.Add("@userId", BorrowBookUserTextBox.Text.Trim());
                dic.Add("@bookId", BorrowBookIdTextBox.Text.Trim());
                dic.Add("@bookName", BorrowBookNameTextBox.Text.Trim());
                dic.Add("@duration", BorrowBookTimeComboBox.Text.ToString().Substring(0, 2));       //借书时长
                dic.Add("@overDue", "0");   // overDue = 0 标记该书未超归还期限 
                dic.Add("@status", "0");
                int isSuccessfull = MySqlHelper.ExecuteNonQuery(sql, dic); //ExecuteNonQuery 返回的参数是影响了几行
                if (isSuccessfull==0)
                {
                    MessageBox.Show("借书成功!", "提示");
                }

/*                sql = string.Format("insert into borrowlist values(@borrowNumber, @userId, @bookId, @bookName, curdate(), date_add(curdate(), interval @duration day), @overDue)");
                MyDictionary dic = new MyDictionary();
                dic.Add("@borrowNumber", borrowNumber);
                dic.Add("@userId", BorrowBookUserTextBox.Text.Trim());
                dic.Add("@bookId", BorrowBookIdTextBox.Text.Trim());
                dic.Add("@bookName", BorrowBookNameTextBox.Text.Trim());
                dic.Add("@duration", BorrowBookTimeComboBox.Text.ToString().Substring(0, 2));       //借书时长
                dic.Add("@overDue", "0");   // overDue = 0 标记该书未超归还期限 
                int isSuccessfull = MySqlHelper.ExecuteNonQuery(sql, dic);
                if (isSuccessfull > 0)
                {
                    n = (Convert.ToInt32(n) - 1).ToString(); // 库存量 -1
                    sql = "update books set amount = @amount where bookId = @bookId";
                    MyDictionary dic2 = new MyDictionary();
                    dic2.Add("@amount", n);
                    dic2.Add("@bookId", BorrowBookIdTextBox.Text.Trim());
                    MySqlHelper.ExecuteScalar(sql, dic2);
                    MessageBox.Show("借书成功!", "提示");
                }*/

            }
        }


    }
}

// the following is the content of file WindowsFormsApp1\BorrowBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class BorrowBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.BorrowBookInputBookNameLabel = new System.Windows.Forms.Label();
            this.SearchBookNameTextBox = new System.Windows.Forms.TextBox();
            this.BorrowBookSearchButton = new System.Windows.Forms.Button();
            this.BorrowBookIdLabel = new System.Windows.Forms.Label();
            this.BorrowBookNameLabel = new System.Windows.Forms.Label();
            this.BorrowBookPriceLabel = new System.Windows.Forms.Label();
            this.BorrowBookNameTextBox = new System.Windows.Forms.TextBox();
            this.BorrowBookIdTextBox = new System.Windows.Forms.TextBox();
            this.BorrowBookPriceTextBox = new System.Windows.Forms.TextBox();
            this.BorrowBookUserTextBox = new System.Windows.Forms.TextBox();
            this.BorrowBookUserLabel = new System.Windows.Forms.Label();
            this.BorrowBookTimeLabel = new System.Windows.Forms.Label();
            this.BorrowBookDataGridView = new System.Windows.Forms.DataGridView();
            this.ColumnBookId = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBookName = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAuthor = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnScore = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPress = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPrice = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAmount = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.BorrowBookTimeComboBox = new System.Windows.Forms.ComboBox();
            this.SubmitButton = new System.Windows.Forms.Button();
            ((System.ComponentModel.ISupportInitialize)(this.BorrowBookDataGridView)).BeginInit();
            this.SuspendLayout();
            // 
            // BorrowBookInputBookNameLabel
            // 
            this.BorrowBookInputBookNameLabel.AutoSize = true;
            this.BorrowBookInputBookNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookInputBookNameLabel.Location = new System.Drawing.Point(118, 36);
            this.BorrowBookInputBookNameLabel.Name = "BorrowBookInputBookNameLabel";
            this.BorrowBookInputBookNameLabel.Size = new System.Drawing.Size(85, 21);
            this.BorrowBookInputBookNameLabel.TabIndex = 0;
            this.BorrowBookInputBookNameLabel.Text = "输入书名：";
            // 
            // SearchBookNameTextBox
            // 
            this.SearchBookNameTextBox.Location = new System.Drawing.Point(209, 32);
            this.SearchBookNameTextBox.Name = "SearchBookNameTextBox";
            this.SearchBookNameTextBox.Size = new System.Drawing.Size(236, 25);
            this.SearchBookNameTextBox.TabIndex = 1;
            // 
            // BorrowBookSearchButton
            // 
            this.BorrowBookSearchButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookSearchButton.Location = new System.Drawing.Point(465, 26);
            this.BorrowBookSearchButton.Name = "BorrowBookSearchButton";
            this.BorrowBookSearchButton.Size = new System.Drawing.Size(75, 33);
            this.BorrowBookSearchButton.TabIndex = 2;
            this.BorrowBookSearchButton.Text = "查询";
            this.BorrowBookSearchButton.UseVisualStyleBackColor = true;
            this.BorrowBookSearchButton.Click += new System.EventHandler(this.BorrowBookSearchButton_Click);
            // 
            // BorrowBookIdLabel
            // 
            this.BorrowBookIdLabel.AutoSize = true;
            this.BorrowBookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookIdLabel.Location = new System.Drawing.Point(118, 78);
            this.BorrowBookIdLabel.Name = "BorrowBookIdLabel";
            this.BorrowBookIdLabel.Size = new System.Drawing.Size(85, 21);
            this.BorrowBookIdLabel.TabIndex = 3;
            this.BorrowBookIdLabel.Text = "图书编号：";
            // 
            // BorrowBookNameLabel
            // 
            this.BorrowBookNameLabel.AutoSize = true;
            this.BorrowBookNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookNameLabel.Location = new System.Drawing.Point(148, 131);
            this.BorrowBookNameLabel.Name = "BorrowBookNameLabel";
            this.BorrowBookNameLabel.Size = new System.Drawing.Size(55, 21);
            this.BorrowBookNameLabel.TabIndex = 4;
            this.BorrowBookNameLabel.Text = "书名：";
            // 
            // BorrowBookPriceLabel
            // 
            this.BorrowBookPriceLabel.AutoSize = true;
            this.BorrowBookPriceLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookPriceLabel.Location = new System.Drawing.Point(148, 184);
            this.BorrowBookPriceLabel.Name = "BorrowBookPriceLabel";
            this.BorrowBookPriceLabel.Size = new System.Drawing.Size(55, 21);
            this.BorrowBookPriceLabel.TabIndex = 5;
            this.BorrowBookPriceLabel.Text = "价格：";
            // 
            // BorrowBookNameTextBox
            // 
            this.BorrowBookNameTextBox.Location = new System.Drawing.Point(209, 127);
            this.BorrowBookNameTextBox.Name = "BorrowBookNameTextBox";
            this.BorrowBookNameTextBox.ReadOnly = true;
            this.BorrowBookNameTextBox.Size = new System.Drawing.Size(236, 25);
            this.BorrowBookNameTextBox.TabIndex = 6;
            // 
            // BorrowBookIdTextBox
            // 
            this.BorrowBookIdTextBox.Location = new System.Drawing.Point(209, 71);
            this.BorrowBookIdTextBox.Name = "BorrowBookIdTextBox";
            this.BorrowBookIdTextBox.ReadOnly = true;
            this.BorrowBookIdTextBox.Size = new System.Drawing.Size(236, 25);
            this.BorrowBookIdTextBox.TabIndex = 7;
            // 
            // BorrowBookPriceTextBox
            // 
            this.BorrowBookPriceTextBox.Location = new System.Drawing.Point(209, 180);
            this.BorrowBookPriceTextBox.Name = "BorrowBookPriceTextBox";
            this.BorrowBookPriceTextBox.ReadOnly = true;
            this.BorrowBookPriceTextBox.Size = new System.Drawing.Size(236, 25);
            this.BorrowBookPriceTextBox.TabIndex = 8;
            // 
            // BorrowBookUserTextBox
            // 
            this.BorrowBookUserTextBox.Location = new System.Drawing.Point(603, 71);
            this.BorrowBookUserTextBox.Name = "BorrowBookUserTextBox";
            this.BorrowBookUserTextBox.ReadOnly = true;
            this.BorrowBookUserTextBox.Size = new System.Drawing.Size(236, 25);
            this.BorrowBookUserTextBox.TabIndex = 9;
            // 
            // BorrowBookUserLabel
            // 
            this.BorrowBookUserLabel.AutoSize = true;
            this.BorrowBookUserLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookUserLabel.Location = new System.Drawing.Point(512, 75);
            this.BorrowBookUserLabel.Name = "BorrowBookUserLabel";
            this.BorrowBookUserLabel.Size = new System.Drawing.Size(85, 21);
            this.BorrowBookUserLabel.TabIndex = 10;
            this.BorrowBookUserLabel.Text = "借书用户：";
            // 
            // BorrowBookTimeLabel
            // 
            this.BorrowBookTimeLabel.AutoSize = true;
            this.BorrowBookTimeLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowBookTimeLabel.Location = new System.Drawing.Point(512, 131);
            this.BorrowBookTimeLabel.Name = "BorrowBookTimeLabel";
            this.BorrowBookTimeLabel.Size = new System.Drawing.Size(85, 21);
            this.BorrowBookTimeLabel.TabIndex = 11;
            this.BorrowBookTimeLabel.Text = "借阅时长：";
            // 
            // BorrowBookDataGridView
            // 
            this.BorrowBookDataGridView.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.BorrowBookDataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.BorrowBookDataGridView.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.ColumnBookId,
            this.ColumnBookName,
            this.ColumnAuthor,
            this.ColumnScore,
            this.ColumnPress,
            this.ColumnPrice,
            this.ColumnAmount});
            this.BorrowBookDataGridView.Location = new System.Drawing.Point(54, 224);
            this.BorrowBookDataGridView.Name = "BorrowBookDataGridView";
            this.BorrowBookDataGridView.RowTemplate.Height = 27;
            this.BorrowBookDataGridView.Size = new System.Drawing.Size(876, 321);
            this.BorrowBookDataGridView.TabIndex = 12;
            this.BorrowBookDataGridView.CellMouseUp += new System.Windows.Forms.DataGridViewCellMouseEventHandler(this.BorrowBookDataGridView_CellMouseUp);
            // 
            // ColumnBookId
            // 
            this.ColumnBookId.DataPropertyName = "bookId";
            this.ColumnBookId.HeaderText = "图书编号";
            this.ColumnBookId.Name = "ColumnBookId";
            // 
            // ColumnBookName
            // 
            this.ColumnBookName.DataPropertyName = "bookName";
            this.ColumnBookName.HeaderText = "书名";
            this.ColumnBookName.Name = "ColumnBookName";
            // 
            // ColumnAuthor
            // 
            this.ColumnAuthor.DataPropertyName = "author";
            this.ColumnAuthor.HeaderText = "作者";
            this.ColumnAuthor.Name = "ColumnAuthor";
            // 
            // ColumnScore
            // 
            this.ColumnScore.DataPropertyName = "score";
            this.ColumnScore.HeaderText = "评分";
            this.ColumnScore.Name = "ColumnScore";
            // 
            // ColumnPress
            // 
            this.ColumnPress.DataPropertyName = "press";
            this.ColumnPress.HeaderText = "出版社";
            this.ColumnPress.Name = "ColumnPress";
            // 
            // ColumnPrice
            // 
            this.ColumnPrice.DataPropertyName = "price";
            this.ColumnPrice.HeaderText = "价格";
            this.ColumnPrice.Name = "ColumnPrice";
            // 
            // ColumnAmount
            // 
            this.ColumnAmount.DataPropertyName = "amount";
            this.ColumnAmount.HeaderText = "库存";
            this.ColumnAmount.Name = "ColumnAmount";
            // 
            // BorrowBookTimeComboBox
            // 
            this.BorrowBookTimeComboBox.FormattingEnabled = true;
            this.BorrowBookTimeComboBox.Items.AddRange(new object[] {
            "30天",
            "60天",
            "90天"});
            this.BorrowBookTimeComboBox.Location = new System.Drawing.Point(605, 127);
            this.BorrowBookTimeComboBox.Name = "BorrowBookTimeComboBox";
            this.BorrowBookTimeComboBox.Size = new System.Drawing.Size(234, 23);
            this.BorrowBookTimeComboBox.TabIndex = 13;
            // 
            // SubmitButton
            // 
            this.SubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SubmitButton.Location = new System.Drawing.Point(516, 172);
            this.SubmitButton.Name = "SubmitButton";
            this.SubmitButton.Size = new System.Drawing.Size(323, 31);
            this.SubmitButton.TabIndex = 14;
            this.SubmitButton.Text = "选择书籍，单击提交";
            this.SubmitButton.UseVisualStyleBackColor = true;
            this.SubmitButton.Click += new System.EventHandler(this.SubmitButton_Click);
            // 
            // BorrowBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(981, 569);
            this.Controls.Add(this.SubmitButton);
            this.Controls.Add(this.BorrowBookTimeComboBox);
            this.Controls.Add(this.BorrowBookDataGridView);
            this.Controls.Add(this.BorrowBookTimeLabel);
            this.Controls.Add(this.BorrowBookUserLabel);
            this.Controls.Add(this.BorrowBookUserTextBox);
            this.Controls.Add(this.BorrowBookPriceTextBox);
            this.Controls.Add(this.BorrowBookIdTextBox);
            this.Controls.Add(this.BorrowBookNameTextBox);
            this.Controls.Add(this.BorrowBookPriceLabel);
            this.Controls.Add(this.BorrowBookNameLabel);
            this.Controls.Add(this.BorrowBookIdLabel);
            this.Controls.Add(this.BorrowBookSearchButton);
            this.Controls.Add(this.SearchBookNameTextBox);
            this.Controls.Add(this.BorrowBookInputBookNameLabel);
            this.Name = "BorrowBookForm";
            this.Text = "借书管理";
            this.Load += new System.EventHandler(this.BorrowBookForm_Load);
            ((System.ComponentModel.ISupportInitialize)(this.BorrowBookDataGridView)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label BorrowBookInputBookNameLabel;
        private System.Windows.Forms.TextBox SearchBookNameTextBox;
        private System.Windows.Forms.Button BorrowBookSearchButton;
        private System.Windows.Forms.Label BorrowBookIdLabel;
        private System.Windows.Forms.Label BorrowBookNameLabel;
        private System.Windows.Forms.Label BorrowBookPriceLabel;
        private System.Windows.Forms.TextBox BorrowBookNameTextBox;
        private System.Windows.Forms.TextBox BorrowBookIdTextBox;
        private System.Windows.Forms.TextBox BorrowBookPriceTextBox;
        private System.Windows.Forms.TextBox BorrowBookUserTextBox;
        private System.Windows.Forms.Label BorrowBookUserLabel;
        private System.Windows.Forms.Label BorrowBookTimeLabel;
        private System.Windows.Forms.DataGridView BorrowBookDataGridView;
        private System.Windows.Forms.ComboBox BorrowBookTimeComboBox;
        private System.Windows.Forms.Button SubmitButton;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookId;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookName;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAuthor;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnScore;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPress;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPrice;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAmount;
    }
}
// the following is the content of file WindowsFormsApp1\changePasswdForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class ChangePasswdForm : Form
    {
        public ChangePasswdForm()
        {
            InitializeComponent();
        }

        private string _ID;
        public string ID
        {
            get { return _ID; }
            set { _ID = value; }
        }
        // 权限标记 值admin为管理员 ，值为user则为普通用户
        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }

        private void SubmitButton_Click(object sender, EventArgs e)
        {
            // 定义数据库查询语句
            string sql;

            if (OldPasswdTextBox.Text.Trim() == "" || NewPasswdTextBox.Text.Trim() == "" || ReenterNewPasswdTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请填写完整", "警告");
            }
            else if (NewPasswdTextBox.Text.Trim().Length < 6 || ReenterNewPasswdTextBox.Text.Trim().Length < 6)
            {
                MessageBox.Show("新密码长度必须大于六位", "提示");
            }
            else if (NewPasswdTextBox.Text.Trim() != ReenterNewPasswdTextBox.Text.Trim())
            {
                MessageBox.Show("两次输入的新密码不一致", "警告");
            }
            else
            {

                if (_Tag == "user")
                {
                    sql = "update users set userPasswd = @newPasswd where userId = @Id and userPasswd = @oldPasswd";
                }
                else
                {
                    sql = "update admin set adminPasswd = @newPasswd where adminId = @Id and adminPasswd = @oldPasswd";
                }

               
                MyDictionary dic = new MyDictionary();
                dic.Add("@newPasswd", NewPasswdTextBox.Text.Trim());
                dic.Add("@Id", ID.ToString());
                dic.Add("@oldPasswd", OldPasswdTextBox.Text.Trim());
                int n = MySqlHelper.ExecuteNonQuery(sql, dic);

                if (n > 0)
                {
                    MessageBox.Show("修改成功", "OK");
                    this.Close();
                }
                else
                {
                    MessageBox.Show("密码错误", "警告");
                }


            }
        }
    }
}

// the following is the content of file WindowsFormsApp1\changePasswdForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class ChangePasswdForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.OldPasswdLabel = new System.Windows.Forms.Label();
            this.OldPasswdTextBox = new System.Windows.Forms.TextBox();
            this.NewPasswdLabel = new System.Windows.Forms.Label();
            this.NewPasswdTextBox = new System.Windows.Forms.TextBox();
            this.ReenterNewPasswdLabel = new System.Windows.Forms.Label();
            this.ReenterNewPasswdTextBox = new System.Windows.Forms.TextBox();
            this.SubmitButton = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // OldPasswdLabel
            // 
            this.OldPasswdLabel.AutoSize = true;
            this.OldPasswdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.OldPasswdLabel.Location = new System.Drawing.Point(102, 64);
            this.OldPasswdLabel.Name = "OldPasswdLabel";
            this.OldPasswdLabel.Size = new System.Drawing.Size(70, 21);
            this.OldPasswdLabel.TabIndex = 0;
            this.OldPasswdLabel.Text = "旧密码：";
            // 
            // OldPasswdTextBox
            // 
            this.OldPasswdTextBox.Location = new System.Drawing.Point(178, 60);
            this.OldPasswdTextBox.Name = "OldPasswdTextBox";
            this.OldPasswdTextBox.Size = new System.Drawing.Size(189, 25);
            this.OldPasswdTextBox.TabIndex = 1;
            // 
            // NewPasswdLabel
            // 
            this.NewPasswdLabel.AutoSize = true;
            this.NewPasswdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.NewPasswdLabel.Location = new System.Drawing.Point(103, 114);
            this.NewPasswdLabel.Name = "NewPasswdLabel";
            this.NewPasswdLabel.Size = new System.Drawing.Size(70, 21);
            this.NewPasswdLabel.TabIndex = 2;
            this.NewPasswdLabel.Text = "新密码：";
            // 
            // NewPasswdTextBox
            // 
            this.NewPasswdTextBox.Location = new System.Drawing.Point(178, 110);
            this.NewPasswdTextBox.Name = "NewPasswdTextBox";
            this.NewPasswdTextBox.Size = new System.Drawing.Size(189, 25);
            this.NewPasswdTextBox.TabIndex = 3;
            // 
            // ReenterNewPasswdLabel
            // 
            this.ReenterNewPasswdLabel.AutoSize = true;
            this.ReenterNewPasswdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReenterNewPasswdLabel.Location = new System.Drawing.Point(45, 164);
            this.ReenterNewPasswdLabel.Name = "ReenterNewPasswdLabel";
            this.ReenterNewPasswdLabel.Size = new System.Drawing.Size(130, 21);
            this.ReenterNewPasswdLabel.TabIndex = 4;
            this.ReenterNewPasswdLabel.Text = "重新输入新密码：";
            // 
            // ReenterNewPasswdTextBox
            // 
            this.ReenterNewPasswdTextBox.Location = new System.Drawing.Point(178, 160);
            this.ReenterNewPasswdTextBox.Name = "ReenterNewPasswdTextBox";
            this.ReenterNewPasswdTextBox.Size = new System.Drawing.Size(189, 25);
            this.ReenterNewPasswdTextBox.TabIndex = 5;
            // 
            // SubmitButton
            // 
            this.SubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SubmitButton.Location = new System.Drawing.Point(178, 216);
            this.SubmitButton.Name = "SubmitButton";
            this.SubmitButton.Size = new System.Drawing.Size(189, 32);
            this.SubmitButton.TabIndex = 6;
            this.SubmitButton.Text = "提交";
            this.SubmitButton.UseVisualStyleBackColor = true;
            this.SubmitButton.Click += new System.EventHandler(this.SubmitButton_Click);
            // 
            // ChangePasswdForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(487, 318);
            this.Controls.Add(this.SubmitButton);
            this.Controls.Add(this.ReenterNewPasswdTextBox);
            this.Controls.Add(this.ReenterNewPasswdLabel);
            this.Controls.Add(this.NewPasswdTextBox);
            this.Controls.Add(this.NewPasswdLabel);
            this.Controls.Add(this.OldPasswdTextBox);
            this.Controls.Add(this.OldPasswdLabel);
            this.Name = "ChangePasswdForm";
            this.Text = "修改密码";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label OldPasswdLabel;
        private System.Windows.Forms.TextBox OldPasswdTextBox;
        private System.Windows.Forms.Label NewPasswdLabel;
        private System.Windows.Forms.TextBox NewPasswdTextBox;
        private System.Windows.Forms.Label ReenterNewPasswdLabel;
        private System.Windows.Forms.TextBox ReenterNewPasswdTextBox;
        private System.Windows.Forms.Button SubmitButton;
    }
}
// the following is the content of file WindowsFormsApp1\DeleteBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class DeleteBookForm : Form
    {
        public DeleteBookForm()
        {
            InitializeComponent();
        }

        private void DeleteBookForm_Load(object sender, EventArgs e)
        {

        }

        private void DeleteBookButton_Click(object sender, EventArgs e)
        {
            if(DeleteBookIdTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请填写需要注销的图书编号！", "警告");
            }
            else if(!MySqlHelper.IsBookExistsWithId(DeleteBookIdTextBox.Text.Trim()))
            {
                MessageBox.Show("无此图书，请输入正确的图书编号！", "警告");
                return;
            }
            else
            {
                DialogResult dt = MessageBox.Show("确定要注销此用户吗？", "提示", MessageBoxButtons.OKCancel);
                if (dt != DialogResult.OK)
                {
                    return;
                }
                else
                {
                    string sql = "delete from books where bookId = @bookId";
                    MyDictionary dic = new MyDictionary();
                    dic.Add("@bookId", DeleteBookIdTextBox.Text.Trim());
                    int i = MySqlHelper.ExecuteNonQuery(sql, dic);
                    if (i == 1)
                    {
                        MessageBox.Show("注销成功");
                    }
                }
                this.Close();
            }
        }
    }
}

// the following is the content of file WindowsFormsApp1\DeleteBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class DeleteBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.DeleteBookIdLabel = new System.Windows.Forms.Label();
            this.DeleteBookIdTextBox = new System.Windows.Forms.TextBox();
            this.DeleteBookButton = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // DeleteBookIdLabel
            // 
            this.DeleteBookIdLabel.AutoSize = true;
            this.DeleteBookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.DeleteBookIdLabel.Location = new System.Drawing.Point(131, 68);
            this.DeleteBookIdLabel.Name = "DeleteBookIdLabel";
            this.DeleteBookIdLabel.Size = new System.Drawing.Size(85, 21);
            this.DeleteBookIdLabel.TabIndex = 0;
            this.DeleteBookIdLabel.Text = "图书编号：";
            // 
            // DeleteBookIdTextBox
            // 
            this.DeleteBookIdTextBox.Location = new System.Drawing.Point(222, 64);
            this.DeleteBookIdTextBox.Name = "DeleteBookIdTextBox";
            this.DeleteBookIdTextBox.Size = new System.Drawing.Size(189, 25);
            this.DeleteBookIdTextBox.TabIndex = 1;
            // 
            // DeleteBookButton
            // 
            this.DeleteBookButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.DeleteBookButton.Location = new System.Drawing.Point(222, 125);
            this.DeleteBookButton.Name = "DeleteBookButton";
            this.DeleteBookButton.Size = new System.Drawing.Size(189, 31);
            this.DeleteBookButton.TabIndex = 2;
            this.DeleteBookButton.Text = "注销";
            this.DeleteBookButton.UseVisualStyleBackColor = true;
            this.DeleteBookButton.Click += new System.EventHandler(this.DeleteBookButton_Click);
            // 
            // DeleteBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(548, 301);
            this.Controls.Add(this.DeleteBookButton);
            this.Controls.Add(this.DeleteBookIdTextBox);
            this.Controls.Add(this.DeleteBookIdLabel);
            this.Name = "DeleteBookForm";
            this.Text = "删除图书";
            this.Load += new System.EventHandler(this.DeleteBookForm_Load);
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label DeleteBookIdLabel;
        private System.Windows.Forms.TextBox DeleteBookIdTextBox;
        private System.Windows.Forms.Button DeleteBookButton;
    }
}
// the following is the content of file WindowsFormsApp1\LoginForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class LoginForm : Form
    {
        public LoginForm()
        {
            InitializeComponent();
        }
        private void button1_Click(object sender, EventArgs e)
        {
            string ID = textBoxId.Text.Trim();
            string passwd = textBoxPwd.Text.Trim();

            if (ID == "" || passwd == "")
            {
                MessageBox.Show("请输入账号或密码!");
            }
            else
            {
                //数据库连接字符串
                String connectString = "server=localhost;User Id=root;password=asdf;Database=library;";
                //数据库语句
                String sql;

                if (radioButton1.Checked == true)
                {
                    //sql = "select userName from users where userId = '" + ID + "' and userPasswd = '" + passwd + "'";
                    sql = String.Format("select userName from users where userId =  @ID  and userPasswd = @passwd");    //使用参数化查询的方式
                } 
                else
                {
                    sql = String.Format("select adminName from admin where adminId =  @ID  and adminPasswd = @passwd");
                }

                // 构造连接对象
                using (MySqlConnection conn = new MySqlConnection(connectString))
                {
                    MySqlCommand myCommand = new MySqlCommand(sql, conn);

                    //构造参数
                    MySqlParameter[] ps = new MySqlParameter[2];
                    ps[0] = new MySqlParameter("@ID", ID);
                    ps[1] = new MySqlParameter("@passwd", passwd);
                    myCommand.Parameters.AddRange(ps);

                    // 打开数据库连接
                    conn.Open();
                    String name;
                    try
                    {
                        name = myCommand.ExecuteScalar().ToString();
                        //MessageBox.Show(name, "Name");

                        // 登录窗体隐藏
                        this.Hide();
                        // 创建主窗体
                        MainForm mainForm = new MainForm();

                        // 将账号传给主窗体MainForm
                        mainForm.ID = ID;
                        // 用主窗体MainForm下的_Tag标记登陆的是用户还是管理员
                        if (radioButton1.Checked == true)
                        {
                            mainForm._Tag = "user";
                            mainForm.Name1 = name;

                            //sql = "select userBan from users where userId = '" + ID + "' and userPasswd = '" + passwd + "'";
                            sql = String.Format("select userBan from users where userId = @ID  and userPasswd = @passwd");
                            ps[0] = new MySqlParameter("@ID", ID);
                            ps[1] = new MySqlParameter("@passwd", passwd);
                            myCommand = new MySqlCommand(sql, conn);
                            myCommand.Parameters.AddRange(ps);
                            string b = myCommand.ExecuteScalar().ToString();
                            mainForm.B = b;
                        }
                        else
                        {
                            mainForm._Tag = "admin";
                            mainForm.Name1 = name;
                        }
                        conn.Close();
                        //显示主窗体
                        mainForm.ShowDialog();
                    }
                    catch(MySqlException ex)
                    {
                        MessageBox.Show(ex.Message);
                    }
                    catch
                    {
                        MessageBox.Show("账号或密码错误！", "登录失败");
                    }
                    finally
                    {

                    }
                }
            }

        }
    }
}

// the following is the content of file WindowsFormsApp1\LoginForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class LoginForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.label1 = new System.Windows.Forms.Label();
            this.textBoxId = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.textBoxPwd = new System.Windows.Forms.TextBox();
            this.radioButton1 = new System.Windows.Forms.RadioButton();
            this.radioButton2 = new System.Windows.Forms.RadioButton();
            this.button1 = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // label1
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("宋体", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label1.Location = new System.Drawing.Point(143, 81);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(69, 20);
            this.label1.TabIndex = 0;
            this.label1.Text = "账号：";
            // 
            // textBoxId
            // 
            this.textBoxId.Location = new System.Drawing.Point(205, 76);
            this.textBoxId.Name = "textBoxId";
            this.textBoxId.Size = new System.Drawing.Size(181, 25);
            this.textBoxId.TabIndex = 1;
            // 
            // label2
            // 
            this.label2.AutoSize = true;
            this.label2.Font = new System.Drawing.Font("宋体", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label2.Location = new System.Drawing.Point(144, 128);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(69, 20);
            this.label2.TabIndex = 2;
            this.label2.Text = "密码：";
            // 
            // textBoxPwd
            // 
            this.textBoxPwd.Location = new System.Drawing.Point(205, 128);
            this.textBoxPwd.Name = "textBoxPwd";
            this.textBoxPwd.Size = new System.Drawing.Size(181, 25);
            this.textBoxPwd.TabIndex = 3;
            // 
            // radioButton1
            // 
            this.radioButton1.AutoSize = true;
            this.radioButton1.Font = new System.Drawing.Font("宋体", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.radioButton1.Location = new System.Drawing.Point(174, 177);
            this.radioButton1.Name = "radioButton1";
            this.radioButton1.Size = new System.Drawing.Size(70, 24);
            this.radioButton1.TabIndex = 4;
            this.radioButton1.TabStop = true;
            this.radioButton1.Text = "用户";
            this.radioButton1.UseVisualStyleBackColor = true;
            // 
            // radioButton2
            // 
            this.radioButton2.AutoSize = true;
            this.radioButton2.Font = new System.Drawing.Font("宋体", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.radioButton2.Location = new System.Drawing.Point(269, 177);
            this.radioButton2.Name = "radioButton2";
            this.radioButton2.Size = new System.Drawing.Size(90, 24);
            this.radioButton2.TabIndex = 5;
            this.radioButton2.TabStop = true;
            this.radioButton2.Text = "管理员";
            this.radioButton2.UseVisualStyleBackColor = true;
            // 
            // button1
            // 
            this.button1.Font = new System.Drawing.Font("宋体", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.button1.Location = new System.Drawing.Point(225, 221);
            this.button1.Name = "button1";
            this.button1.Size = new System.Drawing.Size(75, 38);
            this.button1.TabIndex = 6;
            this.button1.Text = "登陆";
            this.button1.UseVisualStyleBackColor = true;
            this.button1.Click += new System.EventHandler(this.button1_Click);
            // 
            // LoginForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(513, 308);
            this.Controls.Add(this.button1);
            this.Controls.Add(this.radioButton2);
            this.Controls.Add(this.radioButton1);
            this.Controls.Add(this.textBoxPwd);
            this.Controls.Add(this.label2);
            this.Controls.Add(this.textBoxId);
            this.Controls.Add(this.label1);
            this.Name = "LoginForm";
            this.Text = "图书管理系统 - 登陆";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox textBoxId;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.TextBox textBoxPwd;
        private System.Windows.Forms.RadioButton radioButton1;
        private System.Windows.Forms.RadioButton radioButton2;
        private System.Windows.Forms.Button button1;
    }
}
// the following is the content of file WindowsFormsApp1\MainForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }
        private string _ID;// 账号
        public string ID
        {
            get { return _ID; }
            set { _ID = value; }
        }

        private string _name;
        public string Name1 // 姓名
        {
            get { return _name; }
            set { _name = value; }
        }

        // 权限标记 值为admin为管理员 ，值为user则为普通用户
        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }

        // 标记账户是否被锁定  1为锁定 
        private string _b;
        public string B
        {
            get { return _b; }
            set { _b = value; }
        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            if (_Tag == "user")
            {
                toolStripStatusLabel4.Text = "权限级别：普通用户";
                toolStripStatusLabel1.Text = "   " + Name1;

                //用户权限设置
                AddUserToolStripMenuItem.Enabled = false;
                DeleteUserToolStripMenuItem.Enabled = false;
                AddBookToolStripMenuItem.Enabled = false;
                DeleteBookToolStripMenuItem.Enabled = false;
                书籍信息管理ToolStripMenuItem.Enabled = false;
                
                用户查询ToolStripMenuItem.Enabled = false;
                用户操作确认ToolStripMenuItem1.Enabled = false;

                if (B == "1")
                {
                    toolStripStatusLabel6.Text = "状态：已封禁";
                    MessageBox.Show("账户被锁定，请尽快联系管理员", "警告");
                }
            }
            else
            {
                toolStripStatusLabel4.Text = "权限级别：管理员";
                toolStripStatusLabel1.Text = "   " + Name1;
            }

            //  以下两个步骤可以放到最后再做

            // 窗口加载时处理借书表内逾期的记录 
            string sql = string.Format("update borrowlist set overDue = '1' where returnDate < curdate()");
            MySqlHelper.ExecuteNonQuery(sql);

            // 封禁逾期的用户
            sql = string.Format("update users set userBan = '1' where userId in (select distinct(userId) from borrowlist where overDue = '1')");
            MySqlHelper.ExecuteNonQuery(sql);

        }

        // 退出时关闭所有窗口（login）
        private void MainForm_FormClosed(object sender, FormClosedEventArgs e)
        {
            Application.Exit();
        }

        #region 修改密码
        private void ChangePasswd()
        {
            ChangePasswdForm cPF = new ChangePasswdForm();
            cPF.ID = ID;
            cPF._Tag = _Tag;
            cPF.ShowDialog();
        }

        private void ChangePasswdToolStripMenuItem_Click(object sender, EventArgs e)
        {
            ChangePasswd();
        }
        #endregion
 
        #region 修改个人信息
        private void ModifyUserInfo()
        {
            ModifyUserInfoForm mui = new ModifyUserInfoForm();
            mui.P = "0";
            mui.Id = ID;
            mui._Tag = _Tag;
            mui.ShowDialog();
        }
        private void ModifyUserInfoToolStripMenuItem_Click(object sender, EventArgs e)
        {
            ModifyUserInfo();
        }
        #endregion

        #region 添加用户
        private void AddUser()
        {
            ModifyUserInfoForm mui = new ModifyUserInfoForm();
            mui.Id = ID;
            mui._Tag = _Tag;
            mui.P = "1";
            mui.Text = "新用户注册";
            mui.ShowDialog();
        }

        private void AddUserToolStripMenuItem_Click(object sender, EventArgs e)
        {
            AddUser();
        }
        #endregion

        #region 注销用户
        private void DeleteUserToolStripMenuItem_Click(object sender, EventArgs e)
        {
            ModifyUserInfoForm deleteForm = new ModifyUserInfoForm();
            deleteForm.Text = "注销用户";
            deleteForm.P = "2";
            deleteForm.ShowDialog();
        }
        #endregion

        #region 添加图书
        private void AddBookToolStripMenuItem_Click(object sender, EventArgs e)
        {
            AddBookForm aBF = new AddBookForm();
            aBF.ShowDialog();
        }
        #endregion

        #region 删除图书
        private void DeleteBookToolStripMenuItem_Click(object sender, EventArgs e)
        {
            DeleteBookForm dBF = new DeleteBookForm();
            dBF.ShowDialog();
        }
        #endregion

        #region 图书查询
        private void SearchBookToolStripMenuItem_Click(object sender, EventArgs e)
        {
            SearchBookForm sBF = new SearchBookForm();
            sBF._Tag = this._Tag;
            sBF.ShowDialog();
        }
        #endregion

        #region 借书管理
        private void BorrowBookToolStripMenuItem_Click(object sender, EventArgs e)
        {
            BorrowBookForm bBF = new BorrowBookForm();
            bBF.Id = this.ID;
            bBF._Tag = this._Tag;
            bBF.ShowDialog();
        }
        #endregion

        #region 还书管理
        private void ReturnBookToolStripMenuItem_Click(object sender, EventArgs e)
        {
            ReturnBookForm rBF = new ReturnBookForm();
            rBF.Id = this.ID;
            rBF._Tag = this._Tag;
            rBF.B = this.B;
            rBF.ShowDialog();
        }
        #endregion

        #region 用户查询
        private void 用户查询ToolStripMenuItem_Click(object sender, EventArgs e)
        {
            SearchUserForm sUF = new SearchUserForm();
            sUF._Tag = this._Tag;
            sUF.ShowDialog();
        }
        #endregion

        #region 系统管理
        private void 系统管理ToolStripMenuItem_Click(object sender, EventArgs e)
        {

        }
        #endregion

        #region 操作确认
        private void 操作确认ToolStripMenuItem_Click(object sender, EventArgs e)
        {

        }
        #endregion

        #region 用户操作确认
        private void 用户操作确认ToolStripMenuItem1_Click(object sender, EventArgs e)
        {

        }
        #endregion

        #region 书籍续借
        private void 书籍续借ToolStripMenuItem_Click(object sender, EventArgs e)
        {
            RenewBookForm rBF = new RenewBookForm();
            rBF.Id = this.ID;
            rBF._Tag = this._Tag;
            rBF.ShowDialog();
        }


        #endregion


    }
}

// the following is the content of file WindowsFormsApp1\MainForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class MainForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(MainForm));
            this.menuStrip1 = new System.Windows.Forms.MenuStrip();
            this.系统管理ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.AddUserToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.用户信息修改ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.ModifyUserInfoToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.ChangePasswdToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.DeleteUserToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.图书管理ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.AddBookToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.BorrowBookToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.ReturnBookToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.DeleteBookToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.信息查询ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.SearchBookToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.用户查询ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.用户操作确认ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.用户操作确认ToolStripMenuItem1 = new System.Windows.Forms.ToolStripMenuItem();
            this.statusStrip1 = new System.Windows.Forms.StatusStrip();
            this.toolStripStatusLabel1 = new System.Windows.Forms.ToolStripStatusLabel();
            this.toolStripStatusLabel2 = new System.Windows.Forms.ToolStripStatusLabel();
            this.toolStripStatusLabel3 = new System.Windows.Forms.ToolStripStatusLabel();
            this.toolStripStatusLabel4 = new System.Windows.Forms.ToolStripStatusLabel();
            this.toolStripStatusLabel5 = new System.Windows.Forms.ToolStripStatusLabel();
            this.toolStripStatusLabel6 = new System.Windows.Forms.ToolStripStatusLabel();
            this.书籍续借ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.书籍信息管理ToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.pictureBox1 = new System.Windows.Forms.PictureBox();
            this.menuStrip1.SuspendLayout();
            this.statusStrip1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
            this.SuspendLayout();
            // 
            // menuStrip1
            // 
            this.menuStrip1.ImageScalingSize = new System.Drawing.Size(20, 20);
            this.menuStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.系统管理ToolStripMenuItem,
            this.图书管理ToolStripMenuItem,
            this.用户操作确认ToolStripMenuItem,
            this.信息查询ToolStripMenuItem});
            this.menuStrip1.Location = new System.Drawing.Point(0, 0);
            this.menuStrip1.Name = "menuStrip1";
            this.menuStrip1.Size = new System.Drawing.Size(918, 28);
            this.menuStrip1.TabIndex = 0;
            this.menuStrip1.Text = "menuStrip1";
            // 
            // 系统管理ToolStripMenuItem
            // 
            this.系统管理ToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.AddUserToolStripMenuItem,
            this.用户信息修改ToolStripMenuItem,
            this.DeleteUserToolStripMenuItem});
            this.系统管理ToolStripMenuItem.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.系统管理ToolStripMenuItem.Name = "系统管理ToolStripMenuItem";
            this.系统管理ToolStripMenuItem.Size = new System.Drawing.Size(83, 24);
            this.系统管理ToolStripMenuItem.Text = "用户管理";
            this.系统管理ToolStripMenuItem.Click += new System.EventHandler(this.系统管理ToolStripMenuItem_Click);
            // 
            // AddUserToolStripMenuItem
            // 
            this.AddUserToolStripMenuItem.Name = "AddUserToolStripMenuItem";
            this.AddUserToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.AddUserToolStripMenuItem.Text = "注册用户";
            this.AddUserToolStripMenuItem.Click += new System.EventHandler(this.AddUserToolStripMenuItem_Click);
            // 
            // 用户信息修改ToolStripMenuItem
            // 
            this.用户信息修改ToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.ModifyUserInfoToolStripMenuItem,
            this.ChangePasswdToolStripMenuItem});
            this.用户信息修改ToolStripMenuItem.Name = "用户信息修改ToolStripMenuItem";
            this.用户信息修改ToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.用户信息修改ToolStripMenuItem.Text = "用户信息修改";
            // 
            // ModifyUserInfoToolStripMenuItem
            // 
            this.ModifyUserInfoToolStripMenuItem.Name = "ModifyUserInfoToolStripMenuItem";
            this.ModifyUserInfoToolStripMenuItem.Size = new System.Drawing.Size(152, 26);
            this.ModifyUserInfoToolStripMenuItem.Text = "修改信息";
            this.ModifyUserInfoToolStripMenuItem.Click += new System.EventHandler(this.ModifyUserInfoToolStripMenuItem_Click);
            // 
            // ChangePasswdToolStripMenuItem
            // 
            this.ChangePasswdToolStripMenuItem.Name = "ChangePasswdToolStripMenuItem";
            this.ChangePasswdToolStripMenuItem.Size = new System.Drawing.Size(152, 26);
            this.ChangePasswdToolStripMenuItem.Text = "修改密码";
            this.ChangePasswdToolStripMenuItem.Click += new System.EventHandler(this.ChangePasswdToolStripMenuItem_Click);
            // 
            // DeleteUserToolStripMenuItem
            // 
            this.DeleteUserToolStripMenuItem.Name = "DeleteUserToolStripMenuItem";
            this.DeleteUserToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.DeleteUserToolStripMenuItem.Text = "注销用户";
            this.DeleteUserToolStripMenuItem.Click += new System.EventHandler(this.DeleteUserToolStripMenuItem_Click);
            // 
            // 图书管理ToolStripMenuItem
            // 
            this.图书管理ToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.AddBookToolStripMenuItem,
            this.DeleteBookToolStripMenuItem,
            this.书籍信息管理ToolStripMenuItem,
            this.BorrowBookToolStripMenuItem,
            this.ReturnBookToolStripMenuItem,
            this.书籍续借ToolStripMenuItem});
            this.图书管理ToolStripMenuItem.Name = "图书管理ToolStripMenuItem";
            this.图书管理ToolStripMenuItem.Size = new System.Drawing.Size(83, 24);
            this.图书管理ToolStripMenuItem.Text = "图书管理";
            // 
            // AddBookToolStripMenuItem
            // 
            this.AddBookToolStripMenuItem.Name = "AddBookToolStripMenuItem";
            this.AddBookToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.AddBookToolStripMenuItem.Text = "图书入库";
            this.AddBookToolStripMenuItem.Click += new System.EventHandler(this.AddBookToolStripMenuItem_Click);
            // 
            // BorrowBookToolStripMenuItem
            // 
            this.BorrowBookToolStripMenuItem.Name = "BorrowBookToolStripMenuItem";
            this.BorrowBookToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.BorrowBookToolStripMenuItem.Text = "借书管理";
            this.BorrowBookToolStripMenuItem.Click += new System.EventHandler(this.BorrowBookToolStripMenuItem_Click);
            // 
            // ReturnBookToolStripMenuItem
            // 
            this.ReturnBookToolStripMenuItem.Name = "ReturnBookToolStripMenuItem";
            this.ReturnBookToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.ReturnBookToolStripMenuItem.Text = "还书管理";
            this.ReturnBookToolStripMenuItem.Click += new System.EventHandler(this.ReturnBookToolStripMenuItem_Click);
            // 
            // DeleteBookToolStripMenuItem
            // 
            this.DeleteBookToolStripMenuItem.Name = "DeleteBookToolStripMenuItem";
            this.DeleteBookToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.DeleteBookToolStripMenuItem.Text = "删除图书";
            this.DeleteBookToolStripMenuItem.Click += new System.EventHandler(this.DeleteBookToolStripMenuItem_Click);
            // 
            // 信息查询ToolStripMenuItem
            // 
            this.信息查询ToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.SearchBookToolStripMenuItem,
            this.用户查询ToolStripMenuItem});
            this.信息查询ToolStripMenuItem.Name = "信息查询ToolStripMenuItem";
            this.信息查询ToolStripMenuItem.Size = new System.Drawing.Size(83, 24);
            this.信息查询ToolStripMenuItem.Text = "信息查询";
            // 
            // SearchBookToolStripMenuItem
            // 
            this.SearchBookToolStripMenuItem.Name = "SearchBookToolStripMenuItem";
            this.SearchBookToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.SearchBookToolStripMenuItem.Text = "图书查询";
            this.SearchBookToolStripMenuItem.Click += new System.EventHandler(this.SearchBookToolStripMenuItem_Click);
            // 
            // 用户查询ToolStripMenuItem
            // 
            this.用户查询ToolStripMenuItem.Name = "用户查询ToolStripMenuItem";
            this.用户查询ToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.用户查询ToolStripMenuItem.Text = "用户查询";
            this.用户查询ToolStripMenuItem.Click += new System.EventHandler(this.用户查询ToolStripMenuItem_Click);
            // 
            // 用户操作确认ToolStripMenuItem
            // 
            this.用户操作确认ToolStripMenuItem.DropDownItems.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.用户操作确认ToolStripMenuItem1});
            this.用户操作确认ToolStripMenuItem.Name = "用户操作确认ToolStripMenuItem";
            this.用户操作确认ToolStripMenuItem.Size = new System.Drawing.Size(83, 24);
            this.用户操作确认ToolStripMenuItem.Text = "操作确认";
            this.用户操作确认ToolStripMenuItem.Click += new System.EventHandler(this.操作确认ToolStripMenuItem_Click);
            // 
            // 用户操作确认ToolStripMenuItem1
            // 
            this.用户操作确认ToolStripMenuItem1.Name = "用户操作确认ToolStripMenuItem1";
            this.用户操作确认ToolStripMenuItem1.Size = new System.Drawing.Size(224, 26);
            this.用户操作确认ToolStripMenuItem1.Text = "用户操作确认";
            this.用户操作确认ToolStripMenuItem1.Click += new System.EventHandler(this.用户操作确认ToolStripMenuItem1_Click);
            // 
            // statusStrip1
            // 
            this.statusStrip1.ImageScalingSize = new System.Drawing.Size(20, 20);
            this.statusStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.toolStripStatusLabel1,
            this.toolStripStatusLabel2,
            this.toolStripStatusLabel3,
            this.toolStripStatusLabel4,
            this.toolStripStatusLabel5,
            this.toolStripStatusLabel6});
            this.statusStrip1.Location = new System.Drawing.Point(0, 411);
            this.statusStrip1.Name = "statusStrip1";
            this.statusStrip1.Size = new System.Drawing.Size(918, 26);
            this.statusStrip1.TabIndex = 1;
            this.statusStrip1.Text = "statusStrip1";
            // 
            // toolStripStatusLabel1
            // 
            this.toolStripStatusLabel1.Name = "toolStripStatusLabel1";
            this.toolStripStatusLabel1.Size = new System.Drawing.Size(42, 20);
            this.toolStripStatusLabel1.Text = "   ***";
            // 
            // toolStripStatusLabel2
            // 
            this.toolStripStatusLabel2.Name = "toolStripStatusLabel2";
            this.toolStripStatusLabel2.Size = new System.Drawing.Size(189, 20);
            this.toolStripStatusLabel2.Text = "，欢迎登陆图书管理系统！";
            // 
            // toolStripStatusLabel3
            // 
            this.toolStripStatusLabel3.Name = "toolStripStatusLabel3";
            this.toolStripStatusLabel3.Size = new System.Drawing.Size(97, 20);
            this.toolStripStatusLabel3.Text = "                      ";
            // 
            // toolStripStatusLabel4
            // 
            this.toolStripStatusLabel4.Name = "toolStripStatusLabel4";
            this.toolStripStatusLabel4.Size = new System.Drawing.Size(144, 20);
            this.toolStripStatusLabel4.Text = "权限级别：普通用户";
            // 
            // toolStripStatusLabel5
            // 
            this.toolStripStatusLabel5.Name = "toolStripStatusLabel5";
            this.toolStripStatusLabel5.Size = new System.Drawing.Size(89, 20);
            this.toolStripStatusLabel5.Text = "                    ";
            // 
            // toolStripStatusLabel6
            // 
            this.toolStripStatusLabel6.Name = "toolStripStatusLabel6";
            this.toolStripStatusLabel6.Size = new System.Drawing.Size(84, 20);
            this.toolStripStatusLabel6.Text = "状态：正常";
            // 
            // 书籍续借ToolStripMenuItem
            // 
            this.书籍续借ToolStripMenuItem.Name = "书籍续借ToolStripMenuItem";
            this.书籍续借ToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.书籍续借ToolStripMenuItem.Text = "图书续借";
            this.书籍续借ToolStripMenuItem.Click += new System.EventHandler(this.书籍续借ToolStripMenuItem_Click);
            // 
            // 书籍信息管理ToolStripMenuItem
            // 
            this.书籍信息管理ToolStripMenuItem.Name = "书籍信息管理ToolStripMenuItem";
            this.书籍信息管理ToolStripMenuItem.Size = new System.Drawing.Size(224, 26);
            this.书籍信息管理ToolStripMenuItem.Text = "图书信息管理";
            // 
            // pictureBox1
            // 
            this.pictureBox1.BackgroundImageLayout = System.Windows.Forms.ImageLayout.Stretch;
            this.pictureBox1.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.pictureBox1.Cursor = System.Windows.Forms.Cursors.No;
            this.pictureBox1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.pictureBox1.Enabled = false;
            this.pictureBox1.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox1.Image")));
            this.pictureBox1.Location = new System.Drawing.Point(0, 28);
            this.pictureBox1.Name = "pictureBox1";
            this.pictureBox1.Size = new System.Drawing.Size(918, 383);
            this.pictureBox1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.StretchImage;
            this.pictureBox1.TabIndex = 2;
            this.pictureBox1.TabStop = false;
            // 
            // MainForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.BackgroundImageLayout = System.Windows.Forms.ImageLayout.Stretch;
            this.ClientSize = new System.Drawing.Size(918, 437);
            this.Controls.Add(this.pictureBox1);
            this.Controls.Add(this.statusStrip1);
            this.Controls.Add(this.menuStrip1);
            this.MainMenuStrip = this.menuStrip1;
            this.Name = "MainForm";
            this.Text = "图书管理系统";
            this.Load += new System.EventHandler(this.MainForm_Load);
            this.menuStrip1.ResumeLayout(false);
            this.menuStrip1.PerformLayout();
            this.statusStrip1.ResumeLayout(false);
            this.statusStrip1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.MenuStrip menuStrip1;
        private System.Windows.Forms.ToolStripMenuItem 系统管理ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem AddUserToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 用户信息修改ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem ModifyUserInfoToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem ChangePasswdToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem DeleteUserToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 图书管理ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem AddBookToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem BorrowBookToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem ReturnBookToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem DeleteBookToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 信息查询ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem SearchBookToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 用户查询ToolStripMenuItem;
        private System.Windows.Forms.StatusStrip statusStrip1;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel1;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel2;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel3;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel4;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel5;
        private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel6;
        private System.Windows.Forms.ToolStripMenuItem 用户操作确认ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 用户操作确认ToolStripMenuItem1;
        private System.Windows.Forms.ToolStripMenuItem 书籍续借ToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem 书籍信息管理ToolStripMenuItem;
        private System.Windows.Forms.PictureBox pictureBox1;
    }
}
// the following is the content of file WindowsFormsApp1\ModifyUserInfoForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class ModifyUserInfoForm : Form
    {
        public ModifyUserInfoForm()
        {
            InitializeComponent();
        }

        private string _id;
        public string Id
        {
            get { return _id; }
            set { _id = value; }
        }
        // 权限标记值 admin 为管理员 ，user则为普通用户
        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }
        // P标记用来决定是否隐藏panel
        private string _p;
        public string P
        {
            get { return _p; }
            set { _p = value; }
        }

        #region 窗体配置
        private void ModifyUserInfoForm_Load(object sender, EventArgs e)
        {
            if (P == "1")       // p == "1"  为注册新用户功能
            {
                DeleteUserPanel.Visible = false;
            }
            else if (P == "2")  // p == "2"  为注销用户功能
            {
            }
            else                //          为修改个人信息
            {
                AddUserPanel.Visible = false;
                DeleteUserPanel.Visible = false;
                string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";
                string sql;
                if (_Tag == "user")
                {
                    sql = "select * from users where userId='" + Id + "'";
                }
                else
                {
                    sql = "select * from admin where adminId='" + Id + "'";
                }
                using (MySqlConnection conn = new MySqlConnection(connectString))
                {
                    MySqlCommand myCommand = new MySqlCommand(sql, conn);
                    conn.Open();
                    // ExecuteReader()返回一个Datareader对象，这个对象的内容就是与命令匹配的所有行
                    using (MySqlDataReader reader = myCommand.ExecuteReader())
                    {
                        reader.Read();
                        //MessageBox.Show(reader.GetString(3), "调试");
                        AccountTextBox.Text = reader.GetString(1);
                        NameTextBox.Text = reader.GetString(0);
                        PhoneNumberTextBox.Text = reader.GetString(4);
                        if (_Tag == "user")
                        {
                            if (reader.GetString(5) == "1")
                            {
                                StatusDisplayLabel.Text = "封禁";
                            }
                            else
                            {
                                StatusDisplayLabel.Text = "正常";
                            }
                        }
                        else
                        {
                            StatusDisplayLabel.Text = "正常";
                        }

                        if (reader.GetString(3) == "男")
                        {
                            MaleRadioButton.Checked = true;
                        }
                        else
                        {
                            FemaleRadioButton.Checked = true;
                        }
                    }
                    myCommand.Dispose();
                }
                SubmitButton.Enabled = false;
            }
        }
        private void NameTextBox_TextChanged(object sender, EventArgs e)
        {
            SubmitButton.Enabled = true;
        }
        private void AccountTextBox_TextChanged(object sender, EventArgs e)
        {
            if (AccountTextBox.Text != Id)
            {
                SubmitButton.Enabled = true;
            }
            else
            {
                SubmitButton.Enabled = false;
            }
        }
        private void MaleRadioButton_CheckedChanged(object sender, EventArgs e)
        {
            SubmitButton.Enabled = true;
        }
        private void PhoneNumberTextBox_TextChanged(object sender, EventArgs e)
        {
            SubmitButton.Enabled = true;
        }
        #endregion

        #region 修改用户信息
        private void SubmitButton_Click(object sender, EventArgs e)
        {
            // 判断账号是否存在
            if (AccountTextBox.Text != Id)
            {
                if (MySqlHelper.IsUserExists(AccountTextBox.Text.Trim()))
                {
                    MessageBox.Show("账号已存在!", "提示");
                    return;
                }
            }

            // 完成用户的修改
            string userName = NameTextBox.Text.Trim();
            string userId = AccountTextBox.Text.Trim();
            string userPhoneNumber = PhoneNumberTextBox.Text.Trim();
            string userSex;
            if (MaleRadioButton.Checked == true)
            {
                userSex = "男";
            }
            else
            {
                userSex = "女";
            }

            // 构造sql语句
            string sql;
            if (_Tag == "user")
            {
                sql = "update users set userId = @userId, userName = @userName, userSex = @userSex, userPhoneNumber = @userPhoneNumber where userId = @Id";
            }
            else
            {
                sql = "update admin set adminId = @userId, adminName = @userName, adminSex = @userSex, adminPhoneNumber = @userPhoneNumber where adminId = @Id";
            }

            MyDictionary dic = new MyDictionary();
            dic.Add("@userId", userId);
            dic.Add("@userName", userName);
            dic.Add("@userSex", userSex);
            dic.Add("@userPhoneNumber", userPhoneNumber);
            dic.Add("@Id", Id);
            // 执行并返回
            int i = MySqlHelper.ExecuteNonQuery(sql, dic);

            if (i == 1)
            {
                MessageBox.Show("修改用户信息成功！", "提示");
            }
            this.Close();
        }
        #endregion

        #region 注销用户
        private void DeleteUserButton_Click(object sender, EventArgs e)
        {
            // 判断账号是否存在
            if (!MySqlHelper.IsUserExists(DeleteUserAccountTextBox.Text.Trim()))
            {
                MessageBox.Show("账号不存在！", "提示");
                return;
            }
            else
            {
                DialogResult dt = MessageBox.Show("确定要注销此用户吗？", "提示", MessageBoxButtons.OKCancel);
                if (dt != DialogResult.OK)
                {
                    return;
                }
                else
                {
                    string sql = "select count(*) from borrowlist where userId = @id";
                    MyDictionary dic = new MyDictionary();
                    dic.Add("@id", DeleteUserAccountTextBox.Text.Trim());
                    int havaBookToReturn = Convert.ToInt32(MySqlHelper.ExecuteScalar(sql, dic).ToString());
                    if(havaBookToReturn >= 1)
                    {
                        MessageBox.Show("请该用户先归还图书");
                        return;
                    }

                    sql = "delete from users where userId=@id";
                    int i = MySqlHelper.ExecuteNonQuery(sql, dic);
                    if (i == 1)
                    {
                        MessageBox.Show("注销成功");
                    }
                }
                this.Close();
            }
        }
        #endregion

        #region 注册用户
        private void AddUserSubmitButton_Click(object sender, EventArgs e)
        {
            string userSex = "";
            if (AddUserAccountTextbox.Text.Trim().Length < 5)
            {
                MessageBox.Show("账号长度应该大于5!", "提示");
            }
            else if (AddUserPasswdTextBox.Text.Trim().Length < 5)
            {
                MessageBox.Show("密码长度应该大于5!", "提示");
            }
            else if (AddUserNameLabelTextBox.Text.Trim().Length < 2 || AddUserNameLabelTextBox.Text.Trim().Length > 15)
            {
                MessageBox.Show("姓名长度应该大于1并且小于等于15!", "提示");
            }
            else if (AddUserMaleRadioButton.Checked == false && AddUserFemaleRadioButton.Checked == false)
            {
                MessageBox.Show("请选择性别!", "提示");
            }

            else if (Regex.IsMatch(AddUserPhoneNumberTextBox.Text.Trim(), @"^1\d{10}$") != true && Regex.IsMatch(AddUserPhoneNumberTextBox.Text.Trim(), @"^(\d{3,4}-)?\d{6,8}$") != true)
            {
                MessageBox.Show("请输入合法的手机号码或电话号码!", "提示");
            }

            else
            {
                // 判断判断账号是否存在
                if (MySqlHelper.IsUserExists(AddUserAccountTextbox.Text.Trim()))
                {
                    MessageBox.Show("账号已存在!", "警告");
                    return;
                }

                if (AddUserMaleRadioButton.Checked == true)
                {
                    userSex = "男";
                }
                else
                {
                    userSex = "女";
                }

                // 添加新用户
                string sql = "insert into users (userName,userId,userPasswd,userSex,userPhoneNumber,userBan) values(@userName,@userId,@userPasswd,@userSex,@userPhoneNumber,'0')";
                MyDictionary dic = new MyDictionary();
                dic.Add("@userId", AddUserAccountTextbox.Text.Trim());
                dic.Add("@userPasswd", AddUserPasswdTextBox.Text.Trim());
                dic.Add("@userName", AddUserNameLabelTextBox.Text.Trim());
                dic.Add("@userSex", userSex);
                dic.Add("@userPhoneNumber", AddUserPhoneNumberTextBox.Text.Trim());
                int i = MySqlHelper.ExecuteNonQuery(sql, dic);
                if (i == 1)
                {
                    MessageBox.Show("注册用户成功!", "提示");
                    this.Close();
                }
                else
                {
                    MessageBox.Show("操作失败,请联系管理员!", "警告");
                }
            }
        }
        #endregion
    }
}

// the following is the content of file WindowsFormsApp1\ModifyUserInfoForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class ModifyUserInfoForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.NameLabel = new System.Windows.Forms.Label();
            this.NameTextBox = new System.Windows.Forms.TextBox();
            this.AccountLabel = new System.Windows.Forms.Label();
            this.AccountTextBox = new System.Windows.Forms.TextBox();
            this.MaleRadioButton = new System.Windows.Forms.RadioButton();
            this.SexLabel = new System.Windows.Forms.Label();
            this.FemaleRadioButton = new System.Windows.Forms.RadioButton();
            this.PhoneNumberLabel = new System.Windows.Forms.Label();
            this.PhoneNumberTextBox = new System.Windows.Forms.TextBox();
            this.StatusLabel = new System.Windows.Forms.Label();
            this.StatusDisplayLabel = new System.Windows.Forms.Label();
            this.SubmitButton = new System.Windows.Forms.Button();
            this.AddUserPanel = new System.Windows.Forms.Panel();
            this.DeleteUserPanel = new System.Windows.Forms.Panel();
            this.DeleteUserButton = new System.Windows.Forms.Button();
            this.DeleteUserAccountTextBox = new System.Windows.Forms.TextBox();
            this.DeleteUserAccountLabel = new System.Windows.Forms.Label();
            this.DeleteUserLabel = new System.Windows.Forms.Label();
            this.AddUserPhoneNumberLabel = new System.Windows.Forms.Label();
            this.AddUserFemaleRadioButton = new System.Windows.Forms.RadioButton();
            this.AddUserMaleRadioButton = new System.Windows.Forms.RadioButton();
            this.AddUserPhoneNumberTextBox = new System.Windows.Forms.TextBox();
            this.AddUserPasswdTextBox = new System.Windows.Forms.TextBox();
            this.AddUserNameLabelTextBox = new System.Windows.Forms.TextBox();
            this.AddUserAccountTextbox = new System.Windows.Forms.TextBox();
            this.AddUserSubmitButton = new System.Windows.Forms.Button();
            this.AddUserSexLabel = new System.Windows.Forms.Label();
            this.AddUserPasswdLabel = new System.Windows.Forms.Label();
            this.AddUserNameLabel = new System.Windows.Forms.Label();
            this.AddUserAccountLabel = new System.Windows.Forms.Label();
            this.AddUserPanel.SuspendLayout();
            this.DeleteUserPanel.SuspendLayout();
            this.SuspendLayout();
            // 
            // NameLabel
            // 
            this.NameLabel.AutoSize = true;
            this.NameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.NameLabel.Location = new System.Drawing.Point(189, 47);
            this.NameLabel.Name = "NameLabel";
            this.NameLabel.Size = new System.Drawing.Size(55, 21);
            this.NameLabel.TabIndex = 0;
            this.NameLabel.Text = "姓名：";
            // 
            // NameTextBox
            // 
            this.NameTextBox.Location = new System.Drawing.Point(250, 43);
            this.NameTextBox.Name = "NameTextBox";
            this.NameTextBox.Size = new System.Drawing.Size(193, 25);
            this.NameTextBox.TabIndex = 1;
            this.NameTextBox.TextChanged += new System.EventHandler(this.NameTextBox_TextChanged);
            // 
            // AccountLabel
            // 
            this.AccountLabel.AutoSize = true;
            this.AccountLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AccountLabel.Location = new System.Drawing.Point(189, 88);
            this.AccountLabel.Name = "AccountLabel";
            this.AccountLabel.Size = new System.Drawing.Size(55, 21);
            this.AccountLabel.TabIndex = 2;
            this.AccountLabel.Text = "账号：";
            // 
            // AccountTextBox
            // 
            this.AccountTextBox.Location = new System.Drawing.Point(250, 88);
            this.AccountTextBox.Name = "AccountTextBox";
            this.AccountTextBox.Size = new System.Drawing.Size(193, 25);
            this.AccountTextBox.TabIndex = 3;
            this.AccountTextBox.TextChanged += new System.EventHandler(this.AccountTextBox_TextChanged);
            // 
            // MaleRadioButton
            // 
            this.MaleRadioButton.AutoSize = true;
            this.MaleRadioButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.MaleRadioButton.Location = new System.Drawing.Point(250, 134);
            this.MaleRadioButton.Name = "MaleRadioButton";
            this.MaleRadioButton.Size = new System.Drawing.Size(46, 25);
            this.MaleRadioButton.TabIndex = 4;
            this.MaleRadioButton.TabStop = true;
            this.MaleRadioButton.Text = "男";
            this.MaleRadioButton.UseVisualStyleBackColor = true;
            this.MaleRadioButton.CheckedChanged += new System.EventHandler(this.MaleRadioButton_CheckedChanged);
            // 
            // SexLabel
            // 
            this.SexLabel.AutoSize = true;
            this.SexLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SexLabel.Location = new System.Drawing.Point(189, 136);
            this.SexLabel.Name = "SexLabel";
            this.SexLabel.Size = new System.Drawing.Size(55, 21);
            this.SexLabel.TabIndex = 5;
            this.SexLabel.Text = "性别：";
            // 
            // FemaleRadioButton
            // 
            this.FemaleRadioButton.AutoSize = true;
            this.FemaleRadioButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.FemaleRadioButton.Location = new System.Drawing.Point(302, 134);
            this.FemaleRadioButton.Name = "FemaleRadioButton";
            this.FemaleRadioButton.Size = new System.Drawing.Size(46, 25);
            this.FemaleRadioButton.TabIndex = 6;
            this.FemaleRadioButton.TabStop = true;
            this.FemaleRadioButton.Text = "女";
            this.FemaleRadioButton.UseVisualStyleBackColor = true;
            // 
            // PhoneNumberLabel
            // 
            this.PhoneNumberLabel.AutoSize = true;
            this.PhoneNumberLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.PhoneNumberLabel.Location = new System.Drawing.Point(189, 176);
            this.PhoneNumberLabel.Name = "PhoneNumberLabel";
            this.PhoneNumberLabel.Size = new System.Drawing.Size(55, 21);
            this.PhoneNumberLabel.TabIndex = 7;
            this.PhoneNumberLabel.Text = "电话：";
            // 
            // PhoneNumberTextBox
            // 
            this.PhoneNumberTextBox.Location = new System.Drawing.Point(250, 172);
            this.PhoneNumberTextBox.Name = "PhoneNumberTextBox";
            this.PhoneNumberTextBox.Size = new System.Drawing.Size(193, 25);
            this.PhoneNumberTextBox.TabIndex = 8;
            this.PhoneNumberTextBox.TextChanged += new System.EventHandler(this.PhoneNumberTextBox_TextChanged);
            // 
            // StatusLabel
            // 
            this.StatusLabel.AutoSize = true;
            this.StatusLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.StatusLabel.Location = new System.Drawing.Point(189, 217);
            this.StatusLabel.Name = "StatusLabel";
            this.StatusLabel.Size = new System.Drawing.Size(55, 21);
            this.StatusLabel.TabIndex = 9;
            this.StatusLabel.Text = "状态：";
            // 
            // StatusDisplayLabel
            // 
            this.StatusDisplayLabel.AutoSize = true;
            this.StatusDisplayLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.StatusDisplayLabel.Location = new System.Drawing.Point(250, 217);
            this.StatusDisplayLabel.Name = "StatusDisplayLabel";
            this.StatusDisplayLabel.Size = new System.Drawing.Size(40, 21);
            this.StatusDisplayLabel.TabIndex = 10;
            this.StatusDisplayLabel.Text = "正常";
            // 
            // SubmitButton
            // 
            this.SubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SubmitButton.Location = new System.Drawing.Point(250, 267);
            this.SubmitButton.Name = "SubmitButton";
            this.SubmitButton.Size = new System.Drawing.Size(193, 32);
            this.SubmitButton.TabIndex = 11;
            this.SubmitButton.Text = "提交";
            this.SubmitButton.UseVisualStyleBackColor = true;
            this.SubmitButton.Click += new System.EventHandler(this.SubmitButton_Click);
            // 
            // AddUserPanel
            // 
            this.AddUserPanel.Controls.Add(this.DeleteUserPanel);
            this.AddUserPanel.Controls.Add(this.AddUserPhoneNumberLabel);
            this.AddUserPanel.Controls.Add(this.AddUserFemaleRadioButton);
            this.AddUserPanel.Controls.Add(this.AddUserMaleRadioButton);
            this.AddUserPanel.Controls.Add(this.AddUserPhoneNumberTextBox);
            this.AddUserPanel.Controls.Add(this.AddUserPasswdTextBox);
            this.AddUserPanel.Controls.Add(this.AddUserNameLabelTextBox);
            this.AddUserPanel.Controls.Add(this.AddUserAccountTextbox);
            this.AddUserPanel.Controls.Add(this.AddUserSubmitButton);
            this.AddUserPanel.Controls.Add(this.AddUserSexLabel);
            this.AddUserPanel.Controls.Add(this.AddUserPasswdLabel);
            this.AddUserPanel.Controls.Add(this.AddUserNameLabel);
            this.AddUserPanel.Controls.Add(this.AddUserAccountLabel);
            this.AddUserPanel.Location = new System.Drawing.Point(31, 12);
            this.AddUserPanel.Name = "AddUserPanel";
            this.AddUserPanel.Size = new System.Drawing.Size(560, 333);
            this.AddUserPanel.TabIndex = 12;
            // 
            // DeleteUserPanel
            // 
            this.DeleteUserPanel.Controls.Add(this.DeleteUserButton);
            this.DeleteUserPanel.Controls.Add(this.DeleteUserAccountTextBox);
            this.DeleteUserPanel.Controls.Add(this.DeleteUserAccountLabel);
            this.DeleteUserPanel.Controls.Add(this.DeleteUserLabel);
            this.DeleteUserPanel.Location = new System.Drawing.Point(36, 16);
            this.DeleteUserPanel.Name = "DeleteUserPanel";
            this.DeleteUserPanel.Size = new System.Drawing.Size(487, 301);
            this.DeleteUserPanel.TabIndex = 12;
            // 
            // DeleteUserButton
            // 
            this.DeleteUserButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.DeleteUserButton.Location = new System.Drawing.Point(194, 141);
            this.DeleteUserButton.Name = "DeleteUserButton";
            this.DeleteUserButton.Size = new System.Drawing.Size(182, 35);
            this.DeleteUserButton.TabIndex = 3;
            this.DeleteUserButton.Text = "注销";
            this.DeleteUserButton.UseVisualStyleBackColor = true;
            this.DeleteUserButton.Click += new System.EventHandler(this.DeleteUserButton_Click);
            // 
            // DeleteUserAccountTextBox
            // 
            this.DeleteUserAccountTextBox.Location = new System.Drawing.Point(194, 85);
            this.DeleteUserAccountTextBox.Name = "DeleteUserAccountTextBox";
            this.DeleteUserAccountTextBox.Size = new System.Drawing.Size(182, 25);
            this.DeleteUserAccountTextBox.TabIndex = 2;
            // 
            // DeleteUserAccountLabel
            // 
            this.DeleteUserAccountLabel.AutoSize = true;
            this.DeleteUserAccountLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.DeleteUserAccountLabel.Location = new System.Drawing.Point(133, 89);
            this.DeleteUserAccountLabel.Name = "DeleteUserAccountLabel";
            this.DeleteUserAccountLabel.Size = new System.Drawing.Size(55, 21);
            this.DeleteUserAccountLabel.TabIndex = 1;
            this.DeleteUserAccountLabel.Text = "账号：";
            // 
            // DeleteUserLabel
            // 
            this.DeleteUserLabel.AutoSize = true;
            this.DeleteUserLabel.Font = new System.Drawing.Font("微软雅黑", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.DeleteUserLabel.Location = new System.Drawing.Point(213, 33);
            this.DeleteUserLabel.Name = "DeleteUserLabel";
            this.DeleteUserLabel.Size = new System.Drawing.Size(92, 28);
            this.DeleteUserLabel.TabIndex = 0;
            this.DeleteUserLabel.Text = "注销用户";
            // 
            // AddUserPhoneNumberLabel
            // 
            this.AddUserPhoneNumberLabel.AutoSize = true;
            this.AddUserPhoneNumberLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserPhoneNumberLabel.Location = new System.Drawing.Point(159, 204);
            this.AddUserPhoneNumberLabel.Name = "AddUserPhoneNumberLabel";
            this.AddUserPhoneNumberLabel.Size = new System.Drawing.Size(55, 21);
            this.AddUserPhoneNumberLabel.TabIndex = 11;
            this.AddUserPhoneNumberLabel.Text = "电话：";
            // 
            // AddUserFemaleRadioButton
            // 
            this.AddUserFemaleRadioButton.AutoSize = true;
            this.AddUserFemaleRadioButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserFemaleRadioButton.Location = new System.Drawing.Point(272, 157);
            this.AddUserFemaleRadioButton.Name = "AddUserFemaleRadioButton";
            this.AddUserFemaleRadioButton.Size = new System.Drawing.Size(46, 25);
            this.AddUserFemaleRadioButton.TabIndex = 10;
            this.AddUserFemaleRadioButton.TabStop = true;
            this.AddUserFemaleRadioButton.Text = "女";
            this.AddUserFemaleRadioButton.UseVisualStyleBackColor = true;
            // 
            // AddUserMaleRadioButton
            // 
            this.AddUserMaleRadioButton.AutoSize = true;
            this.AddUserMaleRadioButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserMaleRadioButton.Location = new System.Drawing.Point(220, 157);
            this.AddUserMaleRadioButton.Name = "AddUserMaleRadioButton";
            this.AddUserMaleRadioButton.Size = new System.Drawing.Size(46, 25);
            this.AddUserMaleRadioButton.TabIndex = 9;
            this.AddUserMaleRadioButton.TabStop = true;
            this.AddUserMaleRadioButton.Text = "男";
            this.AddUserMaleRadioButton.UseVisualStyleBackColor = true;
            // 
            // AddUserPhoneNumberTextBox
            // 
            this.AddUserPhoneNumberTextBox.Location = new System.Drawing.Point(220, 200);
            this.AddUserPhoneNumberTextBox.Name = "AddUserPhoneNumberTextBox";
            this.AddUserPhoneNumberTextBox.Size = new System.Drawing.Size(188, 25);
            this.AddUserPhoneNumberTextBox.TabIndex = 8;
            // 
            // AddUserPasswdTextBox
            // 
            this.AddUserPasswdTextBox.Location = new System.Drawing.Point(220, 117);
            this.AddUserPasswdTextBox.Name = "AddUserPasswdTextBox";
            this.AddUserPasswdTextBox.Size = new System.Drawing.Size(188, 25);
            this.AddUserPasswdTextBox.TabIndex = 7;
            // 
            // AddUserNameLabelTextBox
            // 
            this.AddUserNameLabelTextBox.Location = new System.Drawing.Point(220, 82);
            this.AddUserNameLabelTextBox.Name = "AddUserNameLabelTextBox";
            this.AddUserNameLabelTextBox.Size = new System.Drawing.Size(188, 25);
            this.AddUserNameLabelTextBox.TabIndex = 6;
            // 
            // AddUserAccountTextbox
            // 
            this.AddUserAccountTextbox.Location = new System.Drawing.Point(220, 44);
            this.AddUserAccountTextbox.Name = "AddUserAccountTextbox";
            this.AddUserAccountTextbox.Size = new System.Drawing.Size(188, 25);
            this.AddUserAccountTextbox.TabIndex = 5;
            // 
            // AddUserSubmitButton
            // 
            this.AddUserSubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserSubmitButton.Location = new System.Drawing.Point(220, 254);
            this.AddUserSubmitButton.Name = "AddUserSubmitButton";
            this.AddUserSubmitButton.Size = new System.Drawing.Size(188, 32);
            this.AddUserSubmitButton.TabIndex = 4;
            this.AddUserSubmitButton.Text = "提交";
            this.AddUserSubmitButton.UseVisualStyleBackColor = true;
            this.AddUserSubmitButton.Click += new System.EventHandler(this.AddUserSubmitButton_Click);
            // 
            // AddUserSexLabel
            // 
            this.AddUserSexLabel.AutoSize = true;
            this.AddUserSexLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserSexLabel.Location = new System.Drawing.Point(159, 159);
            this.AddUserSexLabel.Name = "AddUserSexLabel";
            this.AddUserSexLabel.Size = new System.Drawing.Size(55, 21);
            this.AddUserSexLabel.TabIndex = 3;
            this.AddUserSexLabel.Text = "性别：";
            // 
            // AddUserPasswdLabel
            // 
            this.AddUserPasswdLabel.AutoSize = true;
            this.AddUserPasswdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserPasswdLabel.Location = new System.Drawing.Point(159, 121);
            this.AddUserPasswdLabel.Name = "AddUserPasswdLabel";
            this.AddUserPasswdLabel.Size = new System.Drawing.Size(55, 21);
            this.AddUserPasswdLabel.TabIndex = 2;
            this.AddUserPasswdLabel.Text = "密码：";
            // 
            // AddUserNameLabel
            // 
            this.AddUserNameLabel.AutoSize = true;
            this.AddUserNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserNameLabel.Location = new System.Drawing.Point(159, 86);
            this.AddUserNameLabel.Name = "AddUserNameLabel";
            this.AddUserNameLabel.Size = new System.Drawing.Size(55, 21);
            this.AddUserNameLabel.TabIndex = 1;
            this.AddUserNameLabel.Text = "姓名：";
            // 
            // AddUserAccountLabel
            // 
            this.AddUserAccountLabel.AutoSize = true;
            this.AddUserAccountLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.AddUserAccountLabel.Location = new System.Drawing.Point(159, 48);
            this.AddUserAccountLabel.Name = "AddUserAccountLabel";
            this.AddUserAccountLabel.Size = new System.Drawing.Size(55, 21);
            this.AddUserAccountLabel.TabIndex = 0;
            this.AddUserAccountLabel.Text = "账号：";
            // 
            // ModifyUserInfoForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(624, 369);
            this.Controls.Add(this.AddUserPanel);
            this.Controls.Add(this.SubmitButton);
            this.Controls.Add(this.StatusDisplayLabel);
            this.Controls.Add(this.StatusLabel);
            this.Controls.Add(this.PhoneNumberTextBox);
            this.Controls.Add(this.PhoneNumberLabel);
            this.Controls.Add(this.FemaleRadioButton);
            this.Controls.Add(this.SexLabel);
            this.Controls.Add(this.MaleRadioButton);
            this.Controls.Add(this.AccountTextBox);
            this.Controls.Add(this.AccountLabel);
            this.Controls.Add(this.NameTextBox);
            this.Controls.Add(this.NameLabel);
            this.Name = "ModifyUserInfoForm";
            this.Text = "ModifyUserInfoForm";
            this.Load += new System.EventHandler(this.ModifyUserInfoForm_Load);
            this.AddUserPanel.ResumeLayout(false);
            this.AddUserPanel.PerformLayout();
            this.DeleteUserPanel.ResumeLayout(false);
            this.DeleteUserPanel.PerformLayout();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label NameLabel;
        private System.Windows.Forms.TextBox NameTextBox;
        private System.Windows.Forms.Label AccountLabel;
        private System.Windows.Forms.TextBox AccountTextBox;
        private System.Windows.Forms.RadioButton MaleRadioButton;
        private System.Windows.Forms.Label SexLabel;
        private System.Windows.Forms.RadioButton FemaleRadioButton;
        private System.Windows.Forms.Label PhoneNumberLabel;
        private System.Windows.Forms.TextBox PhoneNumberTextBox;
        private System.Windows.Forms.Label StatusLabel;
        private System.Windows.Forms.Label StatusDisplayLabel;
        private System.Windows.Forms.Button SubmitButton;
        private System.Windows.Forms.Panel AddUserPanel;
        private System.Windows.Forms.RadioButton AddUserFemaleRadioButton;
        private System.Windows.Forms.RadioButton AddUserMaleRadioButton;
        private System.Windows.Forms.TextBox AddUserPhoneNumberTextBox;
        private System.Windows.Forms.TextBox AddUserPasswdTextBox;
        private System.Windows.Forms.TextBox AddUserNameLabelTextBox;
        private System.Windows.Forms.TextBox AddUserAccountTextbox;
        private System.Windows.Forms.Button AddUserSubmitButton;
        private System.Windows.Forms.Label AddUserSexLabel;
        private System.Windows.Forms.Label AddUserPasswdLabel;
        private System.Windows.Forms.Label AddUserNameLabel;
        private System.Windows.Forms.Label AddUserAccountLabel;
        private System.Windows.Forms.Label AddUserPhoneNumberLabel;
        private System.Windows.Forms.Panel DeleteUserPanel;
        private System.Windows.Forms.TextBox DeleteUserAccountTextBox;
        private System.Windows.Forms.Label DeleteUserAccountLabel;
        private System.Windows.Forms.Label DeleteUserLabel;
        private System.Windows.Forms.Button DeleteUserButton;
    }
}
// the following is the content of file WindowsFormsApp1\MyDictionary.cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace WindowsFormsApp1
{
    public class MyDictionary : Dictionary<string, string>
    {
    }
}

// the following is the content of file WindowsFormsApp1\MySqlHelper.cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data;
using System.Data;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public static class MySqlHelper
    {
        public static bool IsUserExists(string userId)
        {
            bool isExists = false;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                string sql = "select count(*) from users where userId = @userId";
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                myCommand.Parameters.Add(new MySqlParameter("@userId", userId));
                conn.Open();
                int obj = Convert.ToInt32(myCommand.ExecuteScalar());// 返回受影响的行数
                if (obj > 0)
                {
                    isExists = true;
                }
            }
            return isExists;
        }

        public static bool IsBookExistsWithName(string bookName)
        {
            bool isExists = false;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                string sql = "select count(*) from books where bookName = @bookName";
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                myCommand.Parameters.Add(new MySqlParameter("@bookName", bookName));
                conn.Open();
                int obj = Convert.ToInt32(myCommand.ExecuteScalar());// 返回受影响的行数
                if (obj > 0)
                {
                    isExists = true;
                }
            }
            return isExists;
        }
        public static bool IsBookExistsWithId(string bookId)
        {
            bool isExists = false;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";
            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                string sql = "select count(*) from books where bookId = @bookId";
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                myCommand.Parameters.Add(new MySqlParameter("@bookId", bookId));
                conn.Open();
                int obj = Convert.ToInt32(myCommand.ExecuteScalar());// 返回受影响的行数
                if (obj > 0)
                {
                    isExists = true;
                }
            }
            return isExists;
        }
        private static int ExecuteNonQuery(string sql, CommandType type, params MySqlParameter[] ps)
        {
            int rows = -1;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                myCommand.CommandType = type;               // 存储过程 type为StoredProcedure
                myCommand.Parameters.AddRange(ps);
                conn.Open();
                rows = myCommand.ExecuteNonQuery();
            }

            return rows;
        }
        public static int ExecuteNonQuery(string sql, MyDictionary dic)
        {
            MySqlParameter[] ps = new MySqlParameter[dic.Count];
            int index = 0;
            foreach (var item in dic)
            {
                ps[index++] = new MySqlParameter(item.Key, item.Value);
            }
            return ExecuteNonQuery(sql, CommandType.Text, ps);
        }
        public static int ExecuteNonQuery(string sql, CommandType type, MyDictionary dic)
        {
            MySqlParameter[] ps = new MySqlParameter[dic.Count];
            int index = 0;
            foreach (var item in dic)
            {
                ps[index++] = new MySqlParameter(item.Key, item.Value);
            }
            return ExecuteNonQuery(sql, type, ps);
        }

        public static int ExecuteNonQuery(string sql)
        {
            int rows = -1;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                conn.Open();
                rows = myCommand.ExecuteNonQuery();
            }

            return rows;
        }

        // 执行sql语句 返回首行首列
        public static object ExecuteScalar(string sql)
        {
            object obj = null;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                conn.Open();
                obj = myCommand.ExecuteScalar();
            }
            return obj;
        }
        public static object ExecuteScalar(string sql, CommandType type, MyDictionary dic)
        {
            object obj = null;
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                myCommand.CommandType = type;

                //构造参数
                MySqlParameter[] ps = new MySqlParameter[dic.Count];
                int index = 0;
                foreach (var item in dic)
                {
                    ps[index++] = new MySqlParameter(item.Key, item.Value);
                }
                myCommand.Parameters.AddRange(ps);
                //执行命令
                conn.Open();
                obj = myCommand.ExecuteScalar();
            }
            return obj;
        }
        public static object ExecuteScalar(string sql, MyDictionary dic)
        {
            return ExecuteScalar(sql, CommandType.Text, dic);
        }



       
        // 执行查询  返回结果集DataTable  获取列表
        public static DataTable GetList(string sql)
        {
            // 构造数据表，用于存储查询的数据
            DataTable dt = new DataTable();
            // 创建连接对象
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";
            MySqlDataAdapter adapter = new MySqlDataAdapter(sql, connectString);
            adapter.Fill(dt);
            return dt;
        }


        /* 
        // 执行查询  返回结果集DataTable  获取列表
        public static DataTable GetList(string sql, MyDictionary dic)
        {
            // 构造数据表，用于存储查询的数据
            DataTable dt = new DataTable();
            // 创建连接对象
            string connectString = "server=localhost;User Id=root;password=123456;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                // 执行命令
                MySqlCommand myCommand = new MySqlCommand(sql, conn);
                // 构造参数
                MySqlParameter[] ps = new MySqlParameter[dic.Count];
                int index = 0;
                foreach (var item in dic)
                {
                    ps[index++] = new MySqlParameter(item.Key, item.Value);
                }
                myCommand.Parameters.AddRange(ps);
                // 执行命令
                MySqlDataAdapter adapter = new MySqlDataAdapter(myCommand);
                adapter.Fill(dt);
            }
            return dt;
        }
        */
    }
}

// the following is the content of file WindowsFormsApp1\Program.cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Forms;
using MySql.Data.MySqlClient;
using WindowsFormsApp1;

namespace WindowsFormsApplication1
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new LoginForm());
        }
    }
}

// the following is the content of file WindowsFormsApp1\RenewBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class RenewBookForm : Form
    {
        public RenewBookForm()
        {
            InitializeComponent();
        }

        private string _Id;
        public string Id
        {
            get { return _Id; }
            set { _Id = value; }
        }

        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }
        private void RenewBookForm_Load(object sender, EventArgs e)
        {

            RenewBookUserTextBox.ReadOnly = false;
            RenewBookUserTextBox.Text = Id;
            RenewBookUserTextBox.ReadOnly = true;
            if (_Tag == "admin")
            {
                SubmitButton.Enabled = false;
            }
        }

        // 查询图书
        private void RenewBookSearchButton_Click(object sender, EventArgs e)
        {
            //显示该用户
            string sql = string.Format("select bookId, bookName, author, score, press, price, amount from books where bookId IN(select bookId from borrowlist where userId = " + Id + ");");
            DataTable dt = MySqlHelper.GetList(sql);
            this.RenewBookDataGridView.DataSource = dt;

        }

        private void RenewBookDataGridView_CellMouseUp(object sender, DataGridViewCellMouseEventArgs e)
        {
            // 开关文本框的锁定，将表格内的数据显示到文本框内
            int a = RenewBookDataGridView.CurrentRow.Index;
            RenewBookIdTextBox.ReadOnly = false;
            RenewBookNameTextBox.ReadOnly = false;
            RenewBookPriceTextBox.ReadOnly = false;
            RenewBookIdTextBox.Text = RenewBookDataGridView.Rows[a].Cells["ColumnBookId"].Value.ToString();
            RenewBookNameTextBox.Text = RenewBookDataGridView.Rows[a].Cells["ColumnBookName"].Value.ToString();
            RenewBookPriceTextBox.Text = RenewBookDataGridView.Rows[a].Cells["ColumnPrice"].Value.ToString();
            RenewBookIdTextBox.ReadOnly = true;
            RenewBookNameTextBox.ReadOnly = true;
            RenewBookPriceTextBox.ReadOnly = true;
        }

        private void SubmitButton_Click(object sender, EventArgs e)
        {
            if (RenewBookTimeComboBox.Text.ToString().Trim() == "")
            {
                MessageBox.Show("请选择时长！", "警告");
                return;
            }
            else if (RenewBookIdTextBox.Text.Trim() == "" || RenewBookNameTextBox.Text.Trim() == "" || RenewBookPriceTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请选择书籍！", "警告");
            }
            else
            {

                string sql;

                sql = string.Format("call renewBooks(@borrowNumber, @userId, @bookId, @bookName, @duration, @overDue)");//利用处理过程+事务+写锁的方式来处理并发
                MyDictionary dic = new MyDictionary();
                dic.Add("@borrowNumber", "000000");   //borrowNumber使用原先的借阅时候生成的borrowNumber
                dic.Add("@userId", RenewBookUserTextBox.Text.Trim());
                dic.Add("@bookId", RenewBookIdTextBox.Text.Trim());
                dic.Add("@bookName", RenewBookNameTextBox.Text.Trim());
                dic.Add("@duration", RenewBookTimeComboBox.Text.ToString().Substring(0, 2));       //借书时长
                dic.Add("@overDue", "0");   // overDue = 0 标记该书未超归还期限 
                dic.Add("@status", "0");
                int isSuccessfull = MySqlHelper.ExecuteNonQuery(sql, dic); //ExecuteNonQuery 返回的参数是影响了几行
                if (isSuccessfull==0)
                {
                    MessageBox.Show("续借成功!", "提示");
                }

            }
        }

        private void RenewBookTimeLabel_Click(object sender, EventArgs e)
        {

        }

        private void SearchBookNameTextBox_TextChanged(object sender, EventArgs e)
        {

        }

        private void RenewBookInputBookNameLabel_Click(object sender, EventArgs e)
        {

        }
    }
}

// the following is the content of file WindowsFormsApp1\RenewBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class RenewBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.RenewBookSearchButton = new System.Windows.Forms.Button();
            this.RenewBookIdLabel = new System.Windows.Forms.Label();
            this.RenewBookNameLabel = new System.Windows.Forms.Label();
            this.RenewBookPriceLabel = new System.Windows.Forms.Label();
            this.RenewBookNameTextBox = new System.Windows.Forms.TextBox();
            this.RenewBookIdTextBox = new System.Windows.Forms.TextBox();
            this.RenewBookPriceTextBox = new System.Windows.Forms.TextBox();
            this.RenewBookUserTextBox = new System.Windows.Forms.TextBox();
            this.RenewBookUserLabel = new System.Windows.Forms.Label();
            this.RenewBookTimeLabel = new System.Windows.Forms.Label();
            this.RenewBookDataGridView = new System.Windows.Forms.DataGridView();
            this.ColumnBookId = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBookName = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAuthor = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnScore = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPress = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPrice = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAmount = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.RenewBookTimeComboBox = new System.Windows.Forms.ComboBox();
            this.SubmitButton = new System.Windows.Forms.Button();
            this.label1 = new System.Windows.Forms.Label();
            ((System.ComponentModel.ISupportInitialize)(this.RenewBookDataGridView)).BeginInit();
            this.SuspendLayout();
            // 
            // RenewBookSearchButton
            // 
            this.RenewBookSearchButton.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookSearchButton.Location = new System.Drawing.Point(453, 27);
            this.RenewBookSearchButton.Name = "RenewBookSearchButton";
            this.RenewBookSearchButton.Size = new System.Drawing.Size(75, 33);
            this.RenewBookSearchButton.TabIndex = 2;
            this.RenewBookSearchButton.Text = "查询";
            this.RenewBookSearchButton.UseVisualStyleBackColor = true;
            this.RenewBookSearchButton.Click += new System.EventHandler(this.RenewBookSearchButton_Click);
            // 
            // RenewBookIdLabel
            // 
            this.RenewBookIdLabel.AutoSize = true;
            this.RenewBookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookIdLabel.Location = new System.Drawing.Point(118, 78);
            this.RenewBookIdLabel.Name = "RenewBookIdLabel";
            this.RenewBookIdLabel.Size = new System.Drawing.Size(84, 20);
            this.RenewBookIdLabel.TabIndex = 3;
            this.RenewBookIdLabel.Text = "图书编号：";
            // 
            // RenewBookNameLabel
            // 
            this.RenewBookNameLabel.AutoSize = true;
            this.RenewBookNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookNameLabel.Location = new System.Drawing.Point(148, 131);
            this.RenewBookNameLabel.Name = "RenewBookNameLabel";
            this.RenewBookNameLabel.Size = new System.Drawing.Size(54, 20);
            this.RenewBookNameLabel.TabIndex = 4;
            this.RenewBookNameLabel.Text = "书名：";
            // 
            // RenewBookPriceLabel
            // 
            this.RenewBookPriceLabel.AutoSize = true;
            this.RenewBookPriceLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookPriceLabel.Location = new System.Drawing.Point(148, 184);
            this.RenewBookPriceLabel.Name = "RenewBookPriceLabel";
            this.RenewBookPriceLabel.Size = new System.Drawing.Size(54, 20);
            this.RenewBookPriceLabel.TabIndex = 5;
            this.RenewBookPriceLabel.Text = "价格：";
            // 
            // RenewBookNameTextBox
            // 
            this.RenewBookNameTextBox.Location = new System.Drawing.Point(209, 127);
            this.RenewBookNameTextBox.Name = "RenewBookNameTextBox";
            this.RenewBookNameTextBox.ReadOnly = true;
            this.RenewBookNameTextBox.Size = new System.Drawing.Size(236, 25);
            this.RenewBookNameTextBox.TabIndex = 6;
            // 
            // RenewBookIdTextBox
            // 
            this.RenewBookIdTextBox.Location = new System.Drawing.Point(209, 71);
            this.RenewBookIdTextBox.Name = "RenewBookIdTextBox";
            this.RenewBookIdTextBox.ReadOnly = true;
            this.RenewBookIdTextBox.Size = new System.Drawing.Size(236, 25);
            this.RenewBookIdTextBox.TabIndex = 7;
            // 
            // RenewBookPriceTextBox
            // 
            this.RenewBookPriceTextBox.Location = new System.Drawing.Point(209, 180);
            this.RenewBookPriceTextBox.Name = "RenewBookPriceTextBox";
            this.RenewBookPriceTextBox.ReadOnly = true;
            this.RenewBookPriceTextBox.Size = new System.Drawing.Size(236, 25);
            this.RenewBookPriceTextBox.TabIndex = 8;
            // 
            // RenewBookUserTextBox
            // 
            this.RenewBookUserTextBox.Location = new System.Drawing.Point(603, 71);
            this.RenewBookUserTextBox.Name = "RenewBookUserTextBox";
            this.RenewBookUserTextBox.ReadOnly = true;
            this.RenewBookUserTextBox.Size = new System.Drawing.Size(236, 25);
            this.RenewBookUserTextBox.TabIndex = 9;
            // 
            // RenewBookUserLabel
            // 
            this.RenewBookUserLabel.AutoSize = true;
            this.RenewBookUserLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookUserLabel.Location = new System.Drawing.Point(512, 75);
            this.RenewBookUserLabel.Name = "RenewBookUserLabel";
            this.RenewBookUserLabel.Size = new System.Drawing.Size(84, 20);
            this.RenewBookUserLabel.TabIndex = 10;
            this.RenewBookUserLabel.Text = "借书用户：";
            // 
            // RenewBookTimeLabel
            // 
            this.RenewBookTimeLabel.AutoSize = true;
            this.RenewBookTimeLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.RenewBookTimeLabel.Location = new System.Drawing.Point(512, 131);
            this.RenewBookTimeLabel.Name = "RenewBookTimeLabel";
            this.RenewBookTimeLabel.Size = new System.Drawing.Size(84, 20);
            this.RenewBookTimeLabel.TabIndex = 11;
            this.RenewBookTimeLabel.Text = "续借时长：";
            this.RenewBookTimeLabel.Click += new System.EventHandler(this.RenewBookTimeLabel_Click);
            // 
            // RenewBookDataGridView
            // 
            this.RenewBookDataGridView.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.RenewBookDataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.RenewBookDataGridView.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.ColumnBookId,
            this.ColumnBookName,
            this.ColumnAuthor,
            this.ColumnScore,
            this.ColumnPress,
            this.ColumnPrice,
            this.ColumnAmount});
            this.RenewBookDataGridView.Location = new System.Drawing.Point(54, 224);
            this.RenewBookDataGridView.Name = "RenewBookDataGridView";
            this.RenewBookDataGridView.RowHeadersWidth = 51;
            this.RenewBookDataGridView.RowTemplate.Height = 27;
            this.RenewBookDataGridView.Size = new System.Drawing.Size(876, 321);
            this.RenewBookDataGridView.TabIndex = 12;
            this.RenewBookDataGridView.CellMouseUp += new System.Windows.Forms.DataGridViewCellMouseEventHandler(this.RenewBookDataGridView_CellMouseUp);
            // 
            // ColumnBookId
            // 
            this.ColumnBookId.DataPropertyName = "bookId";
            this.ColumnBookId.HeaderText = "图书编号";
            this.ColumnBookId.MinimumWidth = 6;
            this.ColumnBookId.Name = "ColumnBookId";
            // 
            // ColumnBookName
            // 
            this.ColumnBookName.DataPropertyName = "bookName";
            this.ColumnBookName.HeaderText = "书名";
            this.ColumnBookName.MinimumWidth = 6;
            this.ColumnBookName.Name = "ColumnBookName";
            // 
            // ColumnAuthor
            // 
            this.ColumnAuthor.DataPropertyName = "author";
            this.ColumnAuthor.HeaderText = "作者";
            this.ColumnAuthor.MinimumWidth = 6;
            this.ColumnAuthor.Name = "ColumnAuthor";
            // 
            // ColumnScore
            // 
            this.ColumnScore.DataPropertyName = "score";
            this.ColumnScore.HeaderText = "评分";
            this.ColumnScore.MinimumWidth = 6;
            this.ColumnScore.Name = "ColumnScore";
            // 
            // ColumnPress
            // 
            this.ColumnPress.DataPropertyName = "press";
            this.ColumnPress.HeaderText = "出版社";
            this.ColumnPress.MinimumWidth = 6;
            this.ColumnPress.Name = "ColumnPress";
            // 
            // ColumnPrice
            // 
            this.ColumnPrice.DataPropertyName = "price";
            this.ColumnPrice.HeaderText = "价格";
            this.ColumnPrice.MinimumWidth = 6;
            this.ColumnPrice.Name = "ColumnPrice";
            // 
            // ColumnAmount
            // 
            this.ColumnAmount.DataPropertyName = "amount";
            this.ColumnAmount.HeaderText = "库存";
            this.ColumnAmount.MinimumWidth = 6;
            this.ColumnAmount.Name = "ColumnAmount";
            // 
            // RenewBookTimeComboBox
            // 
            this.RenewBookTimeComboBox.FormattingEnabled = true;
            this.RenewBookTimeComboBox.Items.AddRange(new object[] {
            "30天",
            "60天",
            "90天"});
            this.RenewBookTimeComboBox.Location = new System.Drawing.Point(605, 127);
            this.RenewBookTimeComboBox.Name = "RenewBookTimeComboBox";
            this.RenewBookTimeComboBox.Size = new System.Drawing.Size(234, 23);
            this.RenewBookTimeComboBox.TabIndex = 13;
            // 
            // SubmitButton
            // 
            this.SubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SubmitButton.Location = new System.Drawing.Point(516, 172);
            this.SubmitButton.Name = "SubmitButton";
            this.SubmitButton.Size = new System.Drawing.Size(323, 31);
            this.SubmitButton.TabIndex = 14;
            this.SubmitButton.Text = "选择书籍，单击提交";
            this.SubmitButton.UseVisualStyleBackColor = true;
            this.SubmitButton.Click += new System.EventHandler(this.SubmitButton_Click);
            // 
            // label1
            // 
            this.label1.AutoSize = true;
            this.label1.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.label1.Font = new System.Drawing.Font("微软雅黑", 10.8F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label1.Location = new System.Drawing.Point(119, 35);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(316, 25);
            this.label1.TabIndex = 15;
            this.label1.Text = "点击左侧查询，查看需要续借的书籍";
            // 
            // RenewBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1013, 585);
            this.Controls.Add(this.label1);
            this.Controls.Add(this.SubmitButton);
            this.Controls.Add(this.RenewBookTimeComboBox);
            this.Controls.Add(this.RenewBookDataGridView);
            this.Controls.Add(this.RenewBookTimeLabel);
            this.Controls.Add(this.RenewBookUserLabel);
            this.Controls.Add(this.RenewBookUserTextBox);
            this.Controls.Add(this.RenewBookPriceTextBox);
            this.Controls.Add(this.RenewBookIdTextBox);
            this.Controls.Add(this.RenewBookNameTextBox);
            this.Controls.Add(this.RenewBookPriceLabel);
            this.Controls.Add(this.RenewBookNameLabel);
            this.Controls.Add(this.RenewBookIdLabel);
            this.Controls.Add(this.RenewBookSearchButton);
            this.Name = "RenewBookForm";
            this.Text = "续借管理";
            this.Load += new System.EventHandler(this.RenewBookForm_Load);
            ((System.ComponentModel.ISupportInitialize)(this.RenewBookDataGridView)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion
        private System.Windows.Forms.Button RenewBookSearchButton;
        private System.Windows.Forms.Label RenewBookIdLabel;
        private System.Windows.Forms.Label RenewBookNameLabel;
        private System.Windows.Forms.Label RenewBookPriceLabel;
        private System.Windows.Forms.TextBox RenewBookNameTextBox;
        private System.Windows.Forms.TextBox RenewBookIdTextBox;
        private System.Windows.Forms.TextBox RenewBookPriceTextBox;
        private System.Windows.Forms.TextBox RenewBookUserTextBox;
        private System.Windows.Forms.Label RenewBookUserLabel;
        private System.Windows.Forms.Label RenewBookTimeLabel;
        private System.Windows.Forms.DataGridView RenewBookDataGridView;
        private System.Windows.Forms.ComboBox RenewBookTimeComboBox;
        private System.Windows.Forms.Button SubmitButton;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookId;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookName;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAuthor;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnScore;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPress;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPrice;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAmount;
        private System.Windows.Forms.Label label1;
    }
}
// the following is the content of file WindowsFormsApp1\ReturnBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class ReturnBookForm : Form
    {
        public ReturnBookForm()
        {
            InitializeComponent();
        }

        private string _Id;
        public string Id
        {
            get { return _Id; }
            set { _Id = value; }
        }

        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }

        // 标记账户是否被锁定  1为锁定 
        private string _b;
        public string B
        {
            get { return _b; }
            set { _b = value; }
        }

        private void ShowBorrowList()
        {
            string sql;
            if (_Tag == "user")
            {
                sql = string.Format("select borrowNumber, userId, bookId, bookName, borrowingDate, returnDate, overDue from borrowlist where userId = '" + Id + "'");
            }
            else
            {
                sql = string.Format("select borrowNumber, userId, bookId, bookName, borrowingDate, returnDate, overDue from borrowlist where userId = '" + ReturnBookIdTextBox.Text.Trim() + "'");
            }
            DataTable dt = MySqlHelper.GetList(sql);
            this.ReturnBookDataGridView.DataSource = dt;
        }
        private void ReturnBookForm_Load(object sender, EventArgs e)
        {
            if (_Tag == "user")
            {
                ReturnBookSearchButton.Visible = false;
                ReturnBookIdTextBox.ReadOnly = false;
                ReturnBookIdTextBox.Text = Id;
                ReturnBookIdTextBox.ReadOnly = true;
                ShowBorrowList();

                // 被封禁用户禁止提交还书
                if (B == "1")
                {
                    ReturnBookSubmitButton.Enabled = false;
                }
            }
        }

        private void ReturnBookSearchButton_Click(object sender, EventArgs e)
        {
            if(ReturnBookIdTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请填写需要查询的账号！", "警告");
            }
            ShowBorrowList();
        }

        private void ReturnBookDataGridView_CellMouseUp(object sender, DataGridViewCellMouseEventArgs e)
        {
            // 开关文本框的锁定，将表格内的数据显示到文本框内
            int a = ReturnBookDataGridView.CurrentRow.Index;
            BorrowNumberTextBox.ReadOnly = false;
            ReturnBookUserIdTextBox.ReadOnly = false;
            OverDueTextBox.ReadOnly = false;
            BookIdTextBox.ReadOnly = false;
            BookNameTextBox.ReadOnly = false;
            BorrowingDateTextBox.ReadOnly = false;
            ReturnDateTextBox.ReadOnly = false;

            BorrowNumberTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnBorrowNumber"].Value.ToString();
            ReturnBookUserIdTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnUserId"].Value.ToString();
            OverDueTextBox.Text = (ReturnBookDataGridView.Rows[a].Cells["ColumnOverDue"].Value.ToString() == "1") ? "是" : "否";
            BookIdTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnBookId"].Value.ToString();
            BookNameTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnBookName"].Value.ToString();
            BorrowingDateTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnBorrowingDate"].Value.ToString();
            ReturnDateTextBox.Text = ReturnBookDataGridView.Rows[a].Cells["ColumnReturnDate"].Value.ToString();
          
            BorrowNumberTextBox.ReadOnly = true;
            ReturnBookUserIdTextBox.ReadOnly = true;
            OverDueTextBox.ReadOnly = true;
            BookIdTextBox.ReadOnly = true;
            BookNameTextBox.ReadOnly = true;
            BorrowingDateTextBox.ReadOnly = true;
            ReturnDateTextBox.ReadOnly = true;
        }

        private void ReturnBookSubmitButton_Click(object sender, EventArgs e)
        {
            string sql = "select userBan from users where userId = @userID";
            MyDictionary dic3 = new MyDictionary();
            dic3.Add("@userID", ReturnBookUserIdTextBox.Text.Trim());
            if (MySqlHelper.ExecuteScalar(sql, dic3).ToString() == "1")
            {
                MessageBox.Show("因逾期未还书账户被锁定，请及时解锁，并缴纳罚款！", "警告");
                return;
            }
            else if (BorrowNumberTextBox.Text.Trim() == "")
            {
                MessageBox.Show("请选择需要归还的图书！", "警告");
                return;
            }
            else
            {
                // 办理借书手续
                // 删除借书记录 
                sql = "delete from borrowlist where borrowNumber = @borrowNumber";
                MyDictionary dic4 = new MyDictionary();
                dic4.Add("@borrowNumber", BorrowNumberTextBox.Text.Trim());
                MySqlHelper.ExecuteNonQuery(sql, dic4);

                // 得到书籍库存量 并+1
                sql = "select amount from books where bookId = @bookId";
                MyDictionary dic5 = new MyDictionary();
                dic5.Add("@bookId", BookIdTextBox.Text.Trim());
                int n = Convert.ToInt32(MySqlHelper.ExecuteScalar(sql, dic5)) + 1;

                sql = "update books set amount = @amount where bookId = @bookId";
                MyDictionary dic6 = new MyDictionary();
                dic6.Add("@amount", n.ToString());
                dic6.Add("@bookId", BookIdTextBox.Text.Trim());
                MySqlHelper.ExecuteNonQuery(sql, dic6);

                MessageBox.Show("还书完成!", "提示");

                // 刷新借书单
                ShowBorrowList();
            }
        }
    }
}

// the following is the content of file WindowsFormsApp1\ReturnBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class ReturnBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.ReturnBookIdLabel = new System.Windows.Forms.Label();
            this.ReturnBookIdTextBox = new System.Windows.Forms.TextBox();
            this.ReturnBookSearchButton = new System.Windows.Forms.Button();
            this.OverDueLabel = new System.Windows.Forms.Label();
            this.ReturnBookUserIdLabel = new System.Windows.Forms.Label();
            this.label3 = new System.Windows.Forms.Label();
            this.BookIdLabel = new System.Windows.Forms.Label();
            this.BookNameLabel = new System.Windows.Forms.Label();
            this.BorrowingDateLabel = new System.Windows.Forms.Label();
            this.ReturnDateLabel = new System.Windows.Forms.Label();
            this.ReturnBookSubmitButton = new System.Windows.Forms.Button();
            this.ReturnBookDataGridView = new System.Windows.Forms.DataGridView();
            this.BorrowNumberTextBox = new System.Windows.Forms.TextBox();
            this.ReturnBookUserIdTextBox = new System.Windows.Forms.TextBox();
            this.OverDueTextBox = new System.Windows.Forms.TextBox();
            this.BookIdTextBox = new System.Windows.Forms.TextBox();
            this.BookNameTextBox = new System.Windows.Forms.TextBox();
            this.BorrowingDateTextBox = new System.Windows.Forms.TextBox();
            this.ReturnDateTextBox = new System.Windows.Forms.TextBox();
            this.ColumnBorrowNumber = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnUserId = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBookId = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBookName = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBorrowingDate = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnReturnDate = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnOverDue = new System.Windows.Forms.DataGridViewTextBoxColumn();
            ((System.ComponentModel.ISupportInitialize)(this.ReturnBookDataGridView)).BeginInit();
            this.SuspendLayout();
            // 
            // ReturnBookIdLabel
            // 
            this.ReturnBookIdLabel.AutoSize = true;
            this.ReturnBookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReturnBookIdLabel.Location = new System.Drawing.Point(62, 35);
            this.ReturnBookIdLabel.Name = "ReturnBookIdLabel";
            this.ReturnBookIdLabel.Size = new System.Drawing.Size(55, 21);
            this.ReturnBookIdLabel.TabIndex = 0;
            this.ReturnBookIdLabel.Text = "账号：";
            // 
            // ReturnBookIdTextBox
            // 
            this.ReturnBookIdTextBox.Location = new System.Drawing.Point(123, 31);
            this.ReturnBookIdTextBox.Name = "ReturnBookIdTextBox";
            this.ReturnBookIdTextBox.Size = new System.Drawing.Size(231, 25);
            this.ReturnBookIdTextBox.TabIndex = 1;
            // 
            // ReturnBookSearchButton
            // 
            this.ReturnBookSearchButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReturnBookSearchButton.Location = new System.Drawing.Point(377, 21);
            this.ReturnBookSearchButton.Name = "ReturnBookSearchButton";
            this.ReturnBookSearchButton.Size = new System.Drawing.Size(75, 35);
            this.ReturnBookSearchButton.TabIndex = 2;
            this.ReturnBookSearchButton.Text = "查询";
            this.ReturnBookSearchButton.UseVisualStyleBackColor = true;
            this.ReturnBookSearchButton.Click += new System.EventHandler(this.ReturnBookSearchButton_Click);
            // 
            // OverDueLabel
            // 
            this.OverDueLabel.AutoSize = true;
            this.OverDueLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.OverDueLabel.Location = new System.Drawing.Point(32, 181);
            this.OverDueLabel.Name = "OverDueLabel";
            this.OverDueLabel.Size = new System.Drawing.Size(85, 21);
            this.OverDueLabel.TabIndex = 3;
            this.OverDueLabel.Text = "是否逾期：";
            // 
            // ReturnBookUserIdLabel
            // 
            this.ReturnBookUserIdLabel.AutoSize = true;
            this.ReturnBookUserIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReturnBookUserIdLabel.Location = new System.Drawing.Point(62, 135);
            this.ReturnBookUserIdLabel.Name = "ReturnBookUserIdLabel";
            this.ReturnBookUserIdLabel.Size = new System.Drawing.Size(55, 21);
            this.ReturnBookUserIdLabel.TabIndex = 4;
            this.ReturnBookUserIdLabel.Text = "账号：";
            // 
            // label3
            // 
            this.label3.AutoSize = true;
            this.label3.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label3.Location = new System.Drawing.Point(32, 90);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(85, 21);
            this.label3.TabIndex = 5;
            this.label3.Text = "借书单号：";
            // 
            // BookIdLabel
            // 
            this.BookIdLabel.AutoSize = true;
            this.BookIdLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BookIdLabel.Location = new System.Drawing.Point(338, 90);
            this.BookIdLabel.Name = "BookIdLabel";
            this.BookIdLabel.Size = new System.Drawing.Size(85, 21);
            this.BookIdLabel.TabIndex = 6;
            this.BookIdLabel.Text = "图书编号：";
            // 
            // BookNameLabel
            // 
            this.BookNameLabel.AutoSize = true;
            this.BookNameLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BookNameLabel.Location = new System.Drawing.Point(368, 135);
            this.BookNameLabel.Name = "BookNameLabel";
            this.BookNameLabel.Size = new System.Drawing.Size(55, 21);
            this.BookNameLabel.TabIndex = 7;
            this.BookNameLabel.Text = "书名：";
            // 
            // BorrowingDateLabel
            // 
            this.BorrowingDateLabel.AutoSize = true;
            this.BorrowingDateLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.BorrowingDateLabel.Location = new System.Drawing.Point(338, 188);
            this.BorrowingDateLabel.Name = "BorrowingDateLabel";
            this.BorrowingDateLabel.Size = new System.Drawing.Size(85, 21);
            this.BorrowingDateLabel.TabIndex = 9;
            this.BorrowingDateLabel.Text = "借出日期：";
            // 
            // ReturnDateLabel
            // 
            this.ReturnDateLabel.AutoSize = true;
            this.ReturnDateLabel.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReturnDateLabel.Location = new System.Drawing.Point(649, 90);
            this.ReturnDateLabel.Name = "ReturnDateLabel";
            this.ReturnDateLabel.Size = new System.Drawing.Size(85, 21);
            this.ReturnDateLabel.TabIndex = 10;
            this.ReturnDateLabel.Text = "归还日期：";
            // 
            // ReturnBookSubmitButton
            // 
            this.ReturnBookSubmitButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.ReturnBookSubmitButton.Location = new System.Drawing.Point(653, 128);
            this.ReturnBookSubmitButton.Name = "ReturnBookSubmitButton";
            this.ReturnBookSubmitButton.Size = new System.Drawing.Size(252, 35);
            this.ReturnBookSubmitButton.TabIndex = 11;
            this.ReturnBookSubmitButton.Text = "点击图书，提交归还";
            this.ReturnBookSubmitButton.UseVisualStyleBackColor = true;
            this.ReturnBookSubmitButton.Click += new System.EventHandler(this.ReturnBookSubmitButton_Click);
            // 
            // ReturnBookDataGridView
            // 
            this.ReturnBookDataGridView.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.ReturnBookDataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.ReturnBookDataGridView.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.ColumnBorrowNumber,
            this.ColumnUserId,
            this.ColumnBookId,
            this.ColumnBookName,
            this.ColumnBorrowingDate,
            this.ColumnReturnDate,
            this.ColumnOverDue});
            this.ReturnBookDataGridView.Location = new System.Drawing.Point(0, 229);
            this.ReturnBookDataGridView.Name = "ReturnBookDataGridView";
            this.ReturnBookDataGridView.RowTemplate.Height = 27;
            this.ReturnBookDataGridView.Size = new System.Drawing.Size(924, 340);
            this.ReturnBookDataGridView.TabIndex = 12;
            this.ReturnBookDataGridView.CellMouseUp += new System.Windows.Forms.DataGridViewCellMouseEventHandler(this.ReturnBookDataGridView_CellMouseUp);
            // 
            // BorrowNumberTextBox
            // 
            this.BorrowNumberTextBox.Location = new System.Drawing.Point(123, 86);
            this.BorrowNumberTextBox.Name = "BorrowNumberTextBox";
            this.BorrowNumberTextBox.Size = new System.Drawing.Size(165, 25);
            this.BorrowNumberTextBox.TabIndex = 13;
            // 
            // ReturnBookUserIdTextBox
            // 
            this.ReturnBookUserIdTextBox.Location = new System.Drawing.Point(123, 131);
            this.ReturnBookUserIdTextBox.Name = "ReturnBookUserIdTextBox";
            this.ReturnBookUserIdTextBox.Size = new System.Drawing.Size(165, 25);
            this.ReturnBookUserIdTextBox.TabIndex = 14;
            // 
            // OverDueTextBox
            // 
            this.OverDueTextBox.Location = new System.Drawing.Point(123, 181);
            this.OverDueTextBox.Name = "OverDueTextBox";
            this.OverDueTextBox.Size = new System.Drawing.Size(165, 25);
            this.OverDueTextBox.TabIndex = 15;
            // 
            // BookIdTextBox
            // 
            this.BookIdTextBox.Location = new System.Drawing.Point(429, 86);
            this.BookIdTextBox.Name = "BookIdTextBox";
            this.BookIdTextBox.Size = new System.Drawing.Size(165, 25);
            this.BookIdTextBox.TabIndex = 16;
            // 
            // BookNameTextBox
            // 
            this.BookNameTextBox.Location = new System.Drawing.Point(429, 131);
            this.BookNameTextBox.Name = "BookNameTextBox";
            this.BookNameTextBox.Size = new System.Drawing.Size(165, 25);
            this.BookNameTextBox.TabIndex = 17;
            // 
            // BorrowingDateTextBox
            // 
            this.BorrowingDateTextBox.Location = new System.Drawing.Point(429, 184);
            this.BorrowingDateTextBox.Name = "BorrowingDateTextBox";
            this.BorrowingDateTextBox.Size = new System.Drawing.Size(165, 25);
            this.BorrowingDateTextBox.TabIndex = 19;
            // 
            // ReturnDateTextBox
            // 
            this.ReturnDateTextBox.Location = new System.Drawing.Point(740, 86);
            this.ReturnDateTextBox.Name = "ReturnDateTextBox";
            this.ReturnDateTextBox.Size = new System.Drawing.Size(165, 25);
            this.ReturnDateTextBox.TabIndex = 20;
            // 
            // ColumnBorrowNumber
            // 
            this.ColumnBorrowNumber.DataPropertyName = "borrowNumber";
            this.ColumnBorrowNumber.HeaderText = "借书单号";
            this.ColumnBorrowNumber.Name = "ColumnBorrowNumber";
            // 
            // ColumnUserId
            // 
            this.ColumnUserId.DataPropertyName = "userId";
            this.ColumnUserId.HeaderText = "用户账号";
            this.ColumnUserId.Name = "ColumnUserId";
            // 
            // ColumnBookId
            // 
            this.ColumnBookId.DataPropertyName = "bookId";
            this.ColumnBookId.HeaderText = "图书编号";
            this.ColumnBookId.Name = "ColumnBookId";
            // 
            // ColumnBookName
            // 
            this.ColumnBookName.DataPropertyName = "bookName";
            this.ColumnBookName.HeaderText = "书名";
            this.ColumnBookName.Name = "ColumnBookName";
            // 
            // ColumnBorrowingDate
            // 
            this.ColumnBorrowingDate.DataPropertyName = "borrowingDate";
            this.ColumnBorrowingDate.HeaderText = "借书日期";
            this.ColumnBorrowingDate.Name = "ColumnBorrowingDate";
            // 
            // ColumnReturnDate
            // 
            this.ColumnReturnDate.DataPropertyName = "returnDate";
            this.ColumnReturnDate.HeaderText = "还书日期";
            this.ColumnReturnDate.Name = "ColumnReturnDate";
            // 
            // ColumnOverDue
            // 
            this.ColumnOverDue.DataPropertyName = "overDue";
            this.ColumnOverDue.HeaderText = "是否逾期";
            this.ColumnOverDue.Name = "ColumnOverDue";
            // 
            // ReturnBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(923, 569);
            this.Controls.Add(this.ReturnDateTextBox);
            this.Controls.Add(this.BorrowingDateTextBox);
            this.Controls.Add(this.BookNameTextBox);
            this.Controls.Add(this.BookIdTextBox);
            this.Controls.Add(this.OverDueTextBox);
            this.Controls.Add(this.ReturnBookUserIdTextBox);
            this.Controls.Add(this.BorrowNumberTextBox);
            this.Controls.Add(this.ReturnBookDataGridView);
            this.Controls.Add(this.ReturnBookSubmitButton);
            this.Controls.Add(this.ReturnDateLabel);
            this.Controls.Add(this.BorrowingDateLabel);
            this.Controls.Add(this.BookNameLabel);
            this.Controls.Add(this.BookIdLabel);
            this.Controls.Add(this.label3);
            this.Controls.Add(this.ReturnBookUserIdLabel);
            this.Controls.Add(this.OverDueLabel);
            this.Controls.Add(this.ReturnBookSearchButton);
            this.Controls.Add(this.ReturnBookIdTextBox);
            this.Controls.Add(this.ReturnBookIdLabel);
            this.Name = "ReturnBookForm";
            this.Text = "还书管理";
            this.Load += new System.EventHandler(this.ReturnBookForm_Load);
            ((System.ComponentModel.ISupportInitialize)(this.ReturnBookDataGridView)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label ReturnBookIdLabel;
        private System.Windows.Forms.TextBox ReturnBookIdTextBox;
        private System.Windows.Forms.Button ReturnBookSearchButton;
        private System.Windows.Forms.Label OverDueLabel;
        private System.Windows.Forms.Label ReturnBookUserIdLabel;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.Label BookIdLabel;
        private System.Windows.Forms.Label BookNameLabel;
        private System.Windows.Forms.Label BorrowingDateLabel;
        private System.Windows.Forms.Label ReturnDateLabel;
        private System.Windows.Forms.Button ReturnBookSubmitButton;
        private System.Windows.Forms.DataGridView ReturnBookDataGridView;
        private System.Windows.Forms.TextBox BorrowNumberTextBox;
        private System.Windows.Forms.TextBox ReturnBookUserIdTextBox;
        private System.Windows.Forms.TextBox OverDueTextBox;
        private System.Windows.Forms.TextBox BookIdTextBox;
        private System.Windows.Forms.TextBox BookNameTextBox;
        private System.Windows.Forms.TextBox BorrowingDateTextBox;
        private System.Windows.Forms.TextBox ReturnDateTextBox;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBorrowNumber;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnUserId;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookId;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookName;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBorrowingDate;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnReturnDate;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnOverDue;
    }
}
// the following is the content of file WindowsFormsApp1\SearchBookForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class SearchBookForm : Form
    {
        public SearchBookForm()
        {
            InitializeComponent();
        }

        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }

        // pageIndex 标记DGV应该显示第几页
        private int pageIndex;
        // maxIndex 标记DGV的总页数
        int maxIndex;

        private void GetData()
        {
            // 获取页大小
            //int pageSize = 10;
            // 计算最多有多少页--Math.Ceiling--向上取整
            // Convert.ToInt32(SqlHelper.ExecuteScalar("select count(*) from books"))得到数据记录总数
            //maxIndex = (int)Math.Ceiling((Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from books")) * 1.0 / pageSize));
            maxIndex = (int)Math.Ceiling((Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from books")) * 1.0));
            // 获取连接字符串
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                // 判断是否有数据
                // Convert.ToInt32(SqlHelper.ExecuteScalar("select count(*) from books"))得到数据记录总数
                if (Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from books")) > 0 && pageIndex > 0)
                {
                    // 确定有数据才进行查询
                    // 创建表格，用来存储数据
                    DataTable dt = new DataTable();
                    // 构造带分页功能的 sql 语句);
                    string sql = string.Format("select bookId, bookName, author, score, press, price, amount from books LIMIT " + pageIndex + ", 10;");
                    // 构造适配器对象
                    MySqlDataAdapter adapter = new MySqlDataAdapter(sql, connectString);
                    // 传递参数
                    // 本页第一条数据
                    //adapter.SelectCommand.Parameters.AddWithValue("@sIndex", ((pageIndex - 1) * pageSize + 1));
                    // 本页最后一条数据
                    //adapter.SelectCommand.Parameters.AddWithValue("@eIndex", pageIndex * pageSize);
                    // 执行查询
                    adapter.Fill(dt);
                    SearchBookDataGridView.DataSource = dt;
                }
                else if (pageIndex <= 0)
                {
                    pageIndex = 1;
                }
                else
                {
                    MessageBox.Show("没有获取到数据！", "警告");
                }
            }
        }
        private void SearchBookForm_Load(object sender, EventArgs e)
        {
            if (_Tag == "user")
            {
                SearchBookDataGridView.ReadOnly = true;
            }
            pageIndex = 1;
            GetData();
        }

        private void SearchButton_Click(object sender, EventArgs e)
        {
            string sql = string.Format("select bookId, bookName, author, score, press, price, amount from books where bookName like '%" + SearchBookNameTextBox.Text.Trim() + "%'");
            DataTable dt = MySqlHelper.GetList(sql);
            this.SearchBookDataGridView.DataSource = dt;

            /*
            string sql = "select bookId, bookName, author, score, press, price, amount from books where bookName like '%@bookName%'";
            MyDictionary dic = new MyDictionary();
            dic.Add("@bookName", SearchBookNameTextBox.Text.Trim());
            DataTable dt = MySqlHelper.GetList(sql, dic);
            this.SearchBookDataGridView.DataSource = dt;
            */

            /* 可行
            string connectString = "server=localhost;User Id=root;password=123456;Database=library;";
            string sql = string.Format("select bookId, bookName, author, score, press, price, amount from books where bookName like '%" + SearchBookNameTextBox.Text.Trim() + "%'");
            MySqlDataAdapter adapter = new MySqlDataAdapter(sql, connectString);
            DataTable dt = new DataTable();
            adapter.Fill(dt);
            this.SearchBookDataGridView.DataSource = dt;
            */
        }

        private void RefreshToolStripButton_Click(object sender, EventArgs e)
        {
            if (pageIndex <= 0)
            {
                pageIndex = 1;
            }
            GetData();
        }

        private void HomePageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = 1;
            GetData();
        } 

        private void PrePageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = pageIndex - 10;
            if (pageIndex <= 0)
            {
                pageIndex = 1;
            }
            GetData();
        }

        private void NextPageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = pageIndex + 10;
            if (pageIndex >= maxIndex)
            {
                pageIndex = pageIndex - 10;
                MessageBox.Show("到底啦 ！", "提示");
            }
            GetData();
        }

        private void LastPageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = maxIndex - 10;
            GetData();
        }

        private void SearchBookDataGridView_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {

        }
    }
}

// the following is the content of file WindowsFormsApp1\SearchBookForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class SearchBookForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(SearchBookForm));
            this.label1 = new System.Windows.Forms.Label();
            this.SearchBookNameTextBox = new System.Windows.Forms.TextBox();
            this.SearchButton = new System.Windows.Forms.Button();
            this.toolStrip1 = new System.Windows.Forms.ToolStrip();
            this.toolStripLabel1 = new System.Windows.Forms.ToolStripLabel();
            this.RefreshToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.HomePageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.PrePageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.NextPageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.LastPageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.SearchBookDataGridView = new System.Windows.Forms.DataGridView();
            this.ColumnBookId = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnBookName = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAuthor = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnScore = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPress = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnPrice = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ColumnAmount = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.toolStrip1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.SearchBookDataGridView)).BeginInit();
            this.SuspendLayout();
            // 
            // label1
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label1.Location = new System.Drawing.Point(64, 43);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(115, 21);
            this.label1.TabIndex = 1;
            this.label1.Text = "输入书名查询：";
            // 
            // SearchBookNameTextBox
            // 
            this.SearchBookNameTextBox.Location = new System.Drawing.Point(174, 39);
            this.SearchBookNameTextBox.Name = "SearchBookNameTextBox";
            this.SearchBookNameTextBox.Size = new System.Drawing.Size(279, 25);
            this.SearchBookNameTextBox.TabIndex = 3;
            // 
            // SearchButton
            // 
            this.SearchButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SearchButton.Location = new System.Drawing.Point(459, 37);
            this.SearchButton.Name = "SearchButton";
            this.SearchButton.Size = new System.Drawing.Size(75, 32);
            this.SearchButton.TabIndex = 5;
            this.SearchButton.Text = "查找";
            this.SearchButton.UseVisualStyleBackColor = true;
            this.SearchButton.Click += new System.EventHandler(this.SearchButton_Click);
            // 
            // toolStrip1
            // 
            this.toolStrip1.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.toolStrip1.ImageScalingSize = new System.Drawing.Size(20, 20);
            this.toolStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.toolStripLabel1,
            this.RefreshToolStripButton,
            this.HomePageToolStripButton,
            this.PrePageToolStripButton,
            this.NextPageToolStripButton,
            this.LastPageToolStripButton});
            this.toolStrip1.Location = new System.Drawing.Point(0, 535);
            this.toolStrip1.Name = "toolStrip1";
            this.toolStrip1.Size = new System.Drawing.Size(956, 28);
            this.toolStrip1.TabIndex = 6;
            this.toolStrip1.Text = "toolStrip1";
            // 
            // toolStripLabel1
            // 
            this.toolStripLabel1.Name = "toolStripLabel1";
            this.toolStripLabel1.Size = new System.Drawing.Size(50, 25);
            this.toolStripLabel1.Text = "        ";
            // 
            // RefreshToolStripButton
            // 
            this.RefreshToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.RefreshToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("RefreshToolStripButton.Image")));
            this.RefreshToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.RefreshToolStripButton.Name = "RefreshToolStripButton";
            this.RefreshToolStripButton.Size = new System.Drawing.Size(44, 25);
            this.RefreshToolStripButton.Text = "刷新";
            this.RefreshToolStripButton.Click += new System.EventHandler(this.RefreshToolStripButton_Click);
            // 
            // HomePageToolStripButton
            // 
            this.HomePageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.HomePageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("HomePageToolStripButton.Image")));
            this.HomePageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.HomePageToolStripButton.Name = "HomePageToolStripButton";
            this.HomePageToolStripButton.Size = new System.Drawing.Size(44, 25);
            this.HomePageToolStripButton.Text = "首页";
            this.HomePageToolStripButton.Click += new System.EventHandler(this.HomePageToolStripButton_Click);
            // 
            // PrePageToolStripButton
            // 
            this.PrePageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.PrePageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("PrePageToolStripButton.Image")));
            this.PrePageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.PrePageToolStripButton.Name = "PrePageToolStripButton";
            this.PrePageToolStripButton.Size = new System.Drawing.Size(59, 25);
            this.PrePageToolStripButton.Text = "上一页";
            this.PrePageToolStripButton.Click += new System.EventHandler(this.PrePageToolStripButton_Click);
            // 
            // NextPageToolStripButton
            // 
            this.NextPageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.NextPageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("NextPageToolStripButton.Image")));
            this.NextPageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.NextPageToolStripButton.Name = "NextPageToolStripButton";
            this.NextPageToolStripButton.Size = new System.Drawing.Size(59, 25);
            this.NextPageToolStripButton.Text = "下一页";
            this.NextPageToolStripButton.Click += new System.EventHandler(this.NextPageToolStripButton_Click);
            // 
            // LastPageToolStripButton
            // 
            this.LastPageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.LastPageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("LastPageToolStripButton.Image")));
            this.LastPageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.LastPageToolStripButton.Name = "LastPageToolStripButton";
            this.LastPageToolStripButton.Size = new System.Drawing.Size(44, 25);
            this.LastPageToolStripButton.Text = "末页";
            this.LastPageToolStripButton.Click += new System.EventHandler(this.LastPageToolStripButton_Click);
            // 
            // SearchBookDataGridView
            // 
            this.SearchBookDataGridView.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.SearchBookDataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.SearchBookDataGridView.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.ColumnBookId,
            this.ColumnBookName,
            this.ColumnAuthor,
            this.ColumnScore,
            this.ColumnPress,
            this.ColumnPrice,
            this.ColumnAmount});
            this.SearchBookDataGridView.Location = new System.Drawing.Point(68, 75);
            this.SearchBookDataGridView.Name = "SearchBookDataGridView";
            this.SearchBookDataGridView.RowTemplate.Height = 27;
            this.SearchBookDataGridView.Size = new System.Drawing.Size(838, 441);
            this.SearchBookDataGridView.TabIndex = 7;
            // 
            // ColumnBookId
            // 
            this.ColumnBookId.DataPropertyName = "bookId";
            this.ColumnBookId.HeaderText = "图书编号";
            this.ColumnBookId.Name = "ColumnBookId";
            // 
            // ColumnBookName
            // 
            this.ColumnBookName.DataPropertyName = "bookName";
            this.ColumnBookName.HeaderText = "书名";
            this.ColumnBookName.Name = "ColumnBookName";
            // 
            // ColumnAuthor
            // 
            this.ColumnAuthor.DataPropertyName = "author";
            this.ColumnAuthor.HeaderText = "作者";
            this.ColumnAuthor.Name = "ColumnAuthor";
            // 
            // ColumnScore
            // 
            this.ColumnScore.DataPropertyName = "score";
            this.ColumnScore.HeaderText = "评分";
            this.ColumnScore.Name = "ColumnScore";
            // 
            // ColumnPress
            // 
            this.ColumnPress.DataPropertyName = "press";
            this.ColumnPress.HeaderText = "出版社";
            this.ColumnPress.Name = "ColumnPress";
            // 
            // ColumnPrice
            // 
            this.ColumnPrice.DataPropertyName = "price";
            this.ColumnPrice.HeaderText = "价格";
            this.ColumnPrice.Name = "ColumnPrice";
            // 
            // ColumnAmount
            // 
            this.ColumnAmount.DataPropertyName = "amount";
            this.ColumnAmount.HeaderText = "库存";
            this.ColumnAmount.Name = "ColumnAmount";
            // 
            // SearchBookForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(956, 563);
            this.Controls.Add(this.SearchBookDataGridView);
            this.Controls.Add(this.toolStrip1);
            this.Controls.Add(this.SearchButton);
            this.Controls.Add(this.SearchBookNameTextBox);
            this.Controls.Add(this.label1);
            this.Name = "SearchBookForm";
            this.Text = "图书查询";
            this.Load += new System.EventHandler(this.SearchBookForm_Load);
            this.toolStrip1.ResumeLayout(false);
            this.toolStrip1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.SearchBookDataGridView)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion
        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox SearchBookNameTextBox;
        private System.Windows.Forms.Button SearchButton;
        private System.Windows.Forms.ToolStrip toolStrip1;
        private System.Windows.Forms.ToolStripButton RefreshToolStripButton;
        private System.Windows.Forms.ToolStripButton HomePageToolStripButton;
        private System.Windows.Forms.ToolStripButton PrePageToolStripButton;
        private System.Windows.Forms.ToolStripButton NextPageToolStripButton;
        private System.Windows.Forms.ToolStripButton LastPageToolStripButton;
        private System.Windows.Forms.ToolStripLabel toolStripLabel1;
        private System.Windows.Forms.DataGridView SearchBookDataGridView;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookId;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnBookName;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAuthor;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnScore;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPress;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnPrice;
        private System.Windows.Forms.DataGridViewTextBoxColumn ColumnAmount;
    }
}
// the following is the content of file WindowsFormsApp1\SearchUserForm.cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class SearchUserForm : Form
    {
        public SearchUserForm()
        {
            InitializeComponent();
        }

        private string _tag;
        public string _Tag
        {
            get { return _tag; }
            set { _tag = value; }
        }

        // pageIndex 标记DGV应该显示第几页
        private int pageIndex;
        // maxIndex 标记DGV的总页数
        int maxIndex;

        private void GetData()
        {
            // 获取页大小
            //int pageSize = 10;
            // 计算最多有多少页--Math.Ceiling--向上取整
            // Convert.ToInt32(SqlHelper.ExecuteScalar("select count(*) from books"))得到数据记录总数
            //maxIndex = (int)Math.Ceiling((Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from books")) * 1.0 / pageSize));
            maxIndex = (int)Math.Ceiling((Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from users")) * 1.0));
            // 获取连接字符串
            string connectString = "server=localhost;User Id=root;password=asdf;Database=library;";

            using (MySqlConnection conn = new MySqlConnection(connectString))
            {
                // 判断是否有数据
                // Convert.ToInt32(SqlHelper.ExecuteScalar("select count(*) from books"))得到数据记录总数
                if (Convert.ToInt32(MySqlHelper.ExecuteScalar("select count(*) from users")) > 0 && pageIndex > 0)
                {
                    // 确定有数据才进行查询
                    // 创建表格，用来存储数据
                    DataTable dt = new DataTable();
                    // 构造带分页功能的 sql 语句);
                    string sql = string.Format("select userName, userId, userPasswd, userSex, userPhoneNumber, userban from users LIMIT " + pageIndex + ", 10;");
                    // 构造适配器对象
                    MySqlDataAdapter adapter = new MySqlDataAdapter(sql, connectString);
                    // 传递参数
                    // 本页第一条数据
                    //adapter.SelectCommand.Parameters.AddWithValue("@sIndex", ((pageIndex - 1) * pageSize + 1));
                    // 本页最后一条数据
                    //adapter.SelectCommand.Parameters.AddWithValue("@eIndex", pageIndex * pageSize);
                    // 执行查询
                    adapter.Fill(dt);
                    SearchBookDataGridView.DataSource = dt;
                }
                else if (pageIndex <= 0)
                {
                    pageIndex = 1;
                }
                else
                {
                    MessageBox.Show("没有获取到数据！", "警告");
                }
            }
        }
        private void SearchBookForm_Load(object sender, EventArgs e)
        {
            if (_Tag == "user")
            {
                SearchBookDataGridView.ReadOnly = true;
            }
            pageIndex = 1;
            GetData();
        }

        private void SearchButton_Click(object sender, EventArgs e)
        {
            string sql = string.Format("select userName, userId, userPasswd, userSex, userPhoneNumber, userban from users where userName like '%" + SearchBookNameTextBox.Text.Trim() + "%'");
            DataTable dt = MySqlHelper.GetList(sql);
            this.SearchBookDataGridView.DataSource = dt;

        }

        private void RefreshToolStripButton_Click(object sender, EventArgs e)
        {
            if (pageIndex <= 0)
            {
                pageIndex = 1;
            }
            GetData();
        }

        private void HomePageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = 1;
            GetData();
        } 

        private void PrePageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = pageIndex - 10;
            if (pageIndex <= 0)
            {
                pageIndex = 1;
            }
            GetData();
        }

        private void NextPageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = pageIndex + 10;
            if (pageIndex >= maxIndex)
            {
                pageIndex = pageIndex - 10;
                MessageBox.Show("到底啦 ！", "提示");
            }
            GetData();
        }

        private void LastPageToolStripButton_Click(object sender, EventArgs e)
        {
            pageIndex = maxIndex - 10;
            GetData();
        }

        private void SearchBookDataGridView_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {

        }

        private void label1_Click(object sender, EventArgs e)
        {

        }

        private void SearchBookNameTextBox_TextChanged(object sender, EventArgs e)
        {

        }
    }
}

// the following is the content of file WindowsFormsApp1\SearchUserForm.Designer.cs
namespace WindowsFormsApp1
{
    partial class SearchUserForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(SearchUserForm));
            this.label1 = new System.Windows.Forms.Label();
            this.SearchBookNameTextBox = new System.Windows.Forms.TextBox();
            this.SearchButton = new System.Windows.Forms.Button();
            this.toolStrip1 = new System.Windows.Forms.ToolStrip();
            this.toolStripLabel1 = new System.Windows.Forms.ToolStripLabel();
            this.RefreshToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.HomePageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.PrePageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.NextPageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.LastPageToolStripButton = new System.Windows.Forms.ToolStripButton();
            this.SearchBookDataGridView = new System.Windows.Forms.DataGridView();
            this.toolStrip1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.SearchBookDataGridView)).BeginInit();
            this.SuspendLayout();
            // 
            // label1
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.label1.Location = new System.Drawing.Point(64, 43);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(114, 20);
            this.label1.TabIndex = 1;
            this.label1.Text = "输入用户查询：";
            this.label1.Click += new System.EventHandler(this.label1_Click);
            // 
            // SearchBookNameTextBox
            // 
            this.SearchBookNameTextBox.Location = new System.Drawing.Point(174, 39);
            this.SearchBookNameTextBox.Name = "SearchBookNameTextBox";
            this.SearchBookNameTextBox.Size = new System.Drawing.Size(279, 25);
            this.SearchBookNameTextBox.TabIndex = 3;
            this.SearchBookNameTextBox.TextChanged += new System.EventHandler(this.SearchBookNameTextBox_TextChanged);
            // 
            // SearchButton
            // 
            this.SearchButton.Font = new System.Drawing.Font("微软雅黑", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.SearchButton.Location = new System.Drawing.Point(459, 37);
            this.SearchButton.Name = "SearchButton";
            this.SearchButton.Size = new System.Drawing.Size(75, 32);
            this.SearchButton.TabIndex = 5;
            this.SearchButton.Text = "查找";
            this.SearchButton.UseVisualStyleBackColor = true;
            this.SearchButton.Click += new System.EventHandler(this.SearchButton_Click);
            // 
            // toolStrip1
            // 
            this.toolStrip1.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.toolStrip1.ImageScalingSize = new System.Drawing.Size(20, 20);
            this.toolStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.toolStripLabel1,
            this.RefreshToolStripButton,
            this.HomePageToolStripButton,
            this.PrePageToolStripButton,
            this.NextPageToolStripButton,
            this.LastPageToolStripButton});
            this.toolStrip1.Location = new System.Drawing.Point(0, 536);
            this.toolStrip1.Name = "toolStrip1";
            this.toolStrip1.Size = new System.Drawing.Size(956, 27);
            this.toolStrip1.TabIndex = 6;
            this.toolStrip1.Text = "toolStrip1";
            // 
            // toolStripLabel1
            // 
            this.toolStripLabel1.Name = "toolStripLabel1";
            this.toolStripLabel1.Size = new System.Drawing.Size(41, 24);
            this.toolStripLabel1.Text = "        ";
            // 
            // RefreshToolStripButton
            // 
            this.RefreshToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.RefreshToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("RefreshToolStripButton.Image")));
            this.RefreshToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.RefreshToolStripButton.Name = "RefreshToolStripButton";
            this.RefreshToolStripButton.Size = new System.Drawing.Size(43, 24);
            this.RefreshToolStripButton.Text = "刷新";
            this.RefreshToolStripButton.Click += new System.EventHandler(this.RefreshToolStripButton_Click);
            // 
            // HomePageToolStripButton
            // 
            this.HomePageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.HomePageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("HomePageToolStripButton.Image")));
            this.HomePageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.HomePageToolStripButton.Name = "HomePageToolStripButton";
            this.HomePageToolStripButton.Size = new System.Drawing.Size(43, 24);
            this.HomePageToolStripButton.Text = "首页";
            this.HomePageToolStripButton.Click += new System.EventHandler(this.HomePageToolStripButton_Click);
            // 
            // PrePageToolStripButton
            // 
            this.PrePageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.PrePageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("PrePageToolStripButton.Image")));
            this.PrePageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.PrePageToolStripButton.Name = "PrePageToolStripButton";
            this.PrePageToolStripButton.Size = new System.Drawing.Size(58, 24);
            this.PrePageToolStripButton.Text = "上一页";
            this.PrePageToolStripButton.Click += new System.EventHandler(this.PrePageToolStripButton_Click);
            // 
            // NextPageToolStripButton
            // 
            this.NextPageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.NextPageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("NextPageToolStripButton.Image")));
            this.NextPageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.NextPageToolStripButton.Name = "NextPageToolStripButton";
            this.NextPageToolStripButton.Size = new System.Drawing.Size(58, 24);
            this.NextPageToolStripButton.Text = "下一页";
            this.NextPageToolStripButton.Click += new System.EventHandler(this.NextPageToolStripButton_Click);
            // 
            // LastPageToolStripButton
            // 
            this.LastPageToolStripButton.DisplayStyle = System.Windows.Forms.ToolStripItemDisplayStyle.Text;
            this.LastPageToolStripButton.Image = ((System.Drawing.Image)(resources.GetObject("LastPageToolStripButton.Image")));
            this.LastPageToolStripButton.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.LastPageToolStripButton.Name = "LastPageToolStripButton";
            this.LastPageToolStripButton.Size = new System.Drawing.Size(43, 24);
            this.LastPageToolStripButton.Text = "末页";
            this.LastPageToolStripButton.Click += new System.EventHandler(this.LastPageToolStripButton_Click);
            // 
            // SearchBookDataGridView
            // 
            this.SearchBookDataGridView.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.SearchBookDataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.SearchBookDataGridView.Location = new System.Drawing.Point(68, 75);
            this.SearchBookDataGridView.Name = "SearchBookDataGridView";
            this.SearchBookDataGridView.RowHeadersWidth = 51;
            this.SearchBookDataGridView.RowTemplate.Height = 27;
            this.SearchBookDataGridView.Size = new System.Drawing.Size(838, 441);
            this.SearchBookDataGridView.TabIndex = 7;
            // 
            // SearchUserForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(956, 563);
            this.Controls.Add(this.SearchBookDataGridView);
            this.Controls.Add(this.toolStrip1);
            this.Controls.Add(this.SearchButton);
            this.Controls.Add(this.SearchBookNameTextBox);
            this.Controls.Add(this.label1);
            this.Name = "SearchUserForm";
            this.Text = "用户查询";
            this.Load += new System.EventHandler(this.SearchBookForm_Load);
            this.toolStrip1.ResumeLayout(false);
            this.toolStrip1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.SearchBookDataGridView)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion
        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox SearchBookNameTextBox;
        private System.Windows.Forms.Button SearchButton;
        private System.Windows.Forms.ToolStrip toolStrip1;
        private System.Windows.Forms.ToolStripButton RefreshToolStripButton;
        private System.Windows.Forms.ToolStripButton HomePageToolStripButton;
        private System.Windows.Forms.ToolStripButton PrePageToolStripButton;
        private System.Windows.Forms.ToolStripButton NextPageToolStripButton;
        private System.Windows.Forms.ToolStripButton LastPageToolStripButton;
        private System.Windows.Forms.ToolStripLabel toolStripLabel1;
        private System.Windows.Forms.DataGridView SearchBookDataGridView;
    }
}
